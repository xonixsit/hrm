import{c as a,o as l,a as t,e as y,f as Z,z as ee,g as te,h as F,k as c,Q as se,i as d,l as v,u as b,t as n,q as re,n as oe,d as j,F as k,r as _,w as f,v as C,j as S}from"./app-9dTimoHQ.js";import{a as le,r as ae,A as ne}from"./AuthenticatedLayout-C70r_W0u.js";import{P as de}from"./PageLayout-CTKYhI82.js";import{h as N,M as ie,w as ue,J as E}from"./icons-SXpn_Q_X.js";import"./useAuth-CAeTQEJp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAccessibility-Ce70_Dol.js";import"./PageHeader.vue_vue_type_style_index_0_scoped_cac8c3e5_lang-DzWUQTDb.js";import"./PageHeader-Dtt0-2Ug.js";import"./Icon-CIUsNMS7.js";/* empty css                                                                   */function me(V,i){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})])}const ce={class:"max-w-4xl mx-auto space-y-6"},pe={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},be={class:"px-6 py-4 border-b border-gray-200 bg-gray-50"},ve={class:"flex items-center justify-between"},ge={class:"flex items-center space-x-2"},ye={class:"p-6"},fe={class:"mb-4"},xe={class:"flex justify-between text-sm text-gray-600 mb-2"},he={class:"w-full bg-gray-200 rounded-full h-2"},we={class:"flex justify-between text-xs text-gray-500 mt-1"},ke={key:0,class:"text-yellow-600"},_e={key:1},Ce={class:"space-y-2"},Se={key:0,class:"text-sm text-gray-600"},Ee={key:1,class:"text-sm text-green-600"},Me={key:2,class:"text-sm text-red-600"},De={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200"},Te={class:"p-6"},Ie={class:"mt-4"},Pe={class:"text-lg font-medium text-gray-900"},Re={key:0,class:"mt-4 p-4 bg-gray-50 rounded-lg"},Fe={class:"flex items-center justify-between"},je={class:"flex items-center space-x-3"},Ne={class:"text-sm font-medium text-gray-900"},Ve={class:"text-xs text-gray-500"},Be={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200"},$e={class:"p-6 space-y-6"},qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ze={class:"block text-xs font-medium text-gray-600"},Ae=["onUpdate:modelValue"],Ue=["value"],Je={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Le={class:"space-y-3"},Oe={class:"flex items-center"},He={class:"flex items-center"},We={class:"flex items-center"},Qe={class:"flex justify-end pt-4"},Ge=["disabled"],Ke={key:3,class:"bg-white rounded-lg shadow-sm border border-gray-200"},Xe={class:"p-6"},Ye={class:"flex space-x-3"},Ze={key:4,class:"bg-white rounded-lg shadow-sm border border-gray-200"},et={class:"p-6"},tt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},st={class:"text-center p-4 bg-green-50 rounded-lg"},rt={class:"text-2xl font-bold text-green-600"},ot={class:"text-center p-4 bg-red-50 rounded-lg"},lt={class:"text-2xl font-bold text-red-600"},at={class:"text-center p-4 bg-blue-50 rounded-lg"},nt={class:"text-2xl font-bold text-blue-600"},dt={key:0,class:"mt-6"},it={class:"bg-red-50 border border-red-200 rounded-md p-4 max-h-60 overflow-y-auto"},ut={class:"flex justify-end mt-6 space-x-3"},kt={__name:"Import",props:{departments:{type:Array,default:()=>[]}},setup(V){const i=y(null),M=y(!1),x=y([]),g=y({}),u=y({batchSize:25,errorHandling:"continue",skipFirstRow:!0,updateExisting:!1,sendWelcomeEmails:!0}),s=y({active:!1,paused:!1,canPause:!0,fileName:"",progress:0,processed:0,total:0,successCount:0,errorCount:0,currentRecord:"",estimatedTime:""}),p=y(null),D=[{key:"name",label:"Full Name",required:!0},{key:"email",label:"Email Address",required:!0},{key:"job_title",label:"Job Title",required:!1},{key:"department",label:"Department",required:!1},{key:"phone",label:"Phone Number",required:!1},{key:"join_date",label:"Join Date",required:!1},{key:"salary",label:"Salary",required:!1},{key:"contract_type",label:"Contract Type",required:!1}],B=[{label:"Dashboard",href:route("dashboard")},{label:"Employees",href:route("employees.index")},{label:"Import",current:!0}],$=[{id:"back",label:"Back to Employees",variant:"secondary",handler:()=>se.visit(route("employees.index"))}],T=Z(()=>i.value?D.filter(e=>e.required).every(e=>g.value[e.key]):!1),q=r=>{r.preventDefault(),M.value=!1;const e=r.dataTransfer.files;e.length>0&&I({target:{files:e}})},I=async r=>{const e=r.target.files[0];if(!e)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(e.type)&&!e.name.match(/\.(xlsx|xls|csv)$/i)){alert("Please select a valid Excel or CSV file.");return}if(e.size>10*1024*1024){alert("File size must be less than 10MB.");return}i.value=e,await z()},z=async r=>{x.value=["Name","Full Name","Employee Name","Email","Email Address","Work Email","Job Title","Position","Role","Department","Dept","Division","Phone","Phone Number","Mobile","Join Date","Start Date","Hire Date","Salary","Basic Salary","Annual Salary","Contract Type","Employment Type","Status"],A()},A=()=>{const r={name:["name","full name","employee name","full_name","employee_name"],email:["email","email address","work email","email_address","work_email"],job_title:["job title","position","role","job_title"],department:["department","dept","division"],phone:["phone","phone number","mobile","phone_number"],join_date:["join date","start date","hire date","join_date","start_date","hire_date"],salary:["salary","basic salary","annual salary","basic_salary","annual_salary"],contract_type:["contract type","employment type","status","contract_type","employment_type"]};Object.keys(r).forEach(e=>{const o=x.value.find(m=>r[e].includes(m.toLowerCase()));o&&(g.value[e]=o)})},U=()=>{i.value=null,x.value=[],g.value={}},J=r=>{if(r===0)return"0 Bytes";const e=1024,o=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(r)/Math.log(e));return parseFloat((r/Math.pow(e,m)).toFixed(2))+" "+o[m]},L=async()=>{if(!T.value)return;const r=new FormData;r.append("file",i.value),r.append("column_mapping",JSON.stringify(g.value)),r.append("options",JSON.stringify(u.value)),s.value={active:!0,paused:!1,canPause:!0,fileName:i.value.name,progress:0,processed:0,total:0,successCount:0,errorCount:0,currentRecord:"",estimatedTime:"Calculating..."};try{await O()}catch(e){console.error("Import failed:",e),alert("Import failed. Please try again."),h()}},O=async()=>{const r=Math.floor(Math.random()*100)+50;s.value.total=r;for(let e=0;e<r;e++){s.value.paused&&await new Promise(w=>{const R=()=>{s.value.paused?setTimeout(R,100):w()};R()}),await new Promise(w=>setTimeout(w,100)),s.value.processed=e+1,s.value.progress=Math.round((e+1)/r*100),s.value.currentRecord=`Employee ${e+1}`,Math.random()>.1?s.value.successCount++:s.value.errorCount++;const Y=(r-(e+1))*100;s.value.estimatedTime=H(Y)}K()},H=r=>{const e=Math.floor(r/1e3);return e<60?`${e}s`:`${Math.floor(e/60)}m ${e%60}s`},W=()=>{s.value.paused=!0},Q=()=>{s.value.paused=!1},G=()=>{confirm("Are you sure you want to cancel the import? This action cannot be undone.")&&h()},K=()=>{p.value={successful:s.value.successCount,failed:s.value.errorCount,total:s.value.total,errors:s.value.errorCount>0?[{row:5,message:"Invalid email format"},{row:12,message:"Department not found"},{row:23,message:"Missing required field: name"}]:[]},s.value.active=!1},h=()=>{i.value=null,x.value=[],g.value={},s.value={active:!1,paused:!1,canPause:!0,fileName:"",progress:0,processed:0,total:0,successCount:0,errorCount:0,currentRecord:"",estimatedTime:""},p.value=null},P=r=>{const e=document.createElement("a");e.href=route("employees.template",{format:r}),e.download=`employee_template.${r}`,e.click()},X=()=>{console.log("Downloading error report...")};return ee(()=>{document.addEventListener("dragover",r=>r.preventDefault()),document.addEventListener("drop",r=>r.preventDefault())}),(r,e)=>(l(),te(ne,null,{default:F(()=>[c(de,{title:"Import Employees",subtitle:"Bulk import employees from Excel or CSV files",breadcrumbs:B,actions:$},{default:F(()=>[t("div",ce,[s.value.active?(l(),a("div",pe,[t("div",be,[t("div",ve,[e[13]||(e[13]=t("h3",{class:"text-lg font-medium text-gray-900"},"Import Progress",-1)),t("div",ge,[s.value.canPause&&!s.value.paused?(l(),a("button",{key:0,onClick:W,class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[c(b(le),{class:"w-4 h-4 mr-1"}),e[10]||(e[10]=v(" Pause "))])):d("",!0),s.value.paused?(l(),a("button",{key:1,onClick:Q,class:"inline-flex items-center px-3 py-1.5 border border-green-300 shadow-sm text-sm font-medium rounded-md text-green-700 bg-green-50 hover:bg-green-100"},[c(b(ae),{class:"w-4 h-4 mr-1"}),e[11]||(e[11]=v(" Resume "))])):d("",!0),t("button",{onClick:G,class:"inline-flex items-center px-3 py-1.5 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-red-50 hover:bg-red-100"},[c(b(N),{class:"w-4 h-4 mr-1"}),e[12]||(e[12]=v(" Cancel "))])])])]),t("div",ye,[t("div",fe,[t("div",xe,[t("span",null,"Processing "+n(s.value.fileName),1),t("span",null,n(s.value.processed)+" / "+n(s.value.total)+" records",1)]),t("div",he,[t("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:re({width:s.value.progress+"%"})},null,4)]),t("div",we,[t("span",null,n(s.value.progress)+"% complete",1),s.value.paused?(l(),a("span",ke,"Paused")):s.value.estimatedTime?(l(),a("span",_e,n(s.value.estimatedTime)+" remaining",1)):d("",!0)])]),t("div",Ce,[s.value.currentRecord?(l(),a("div",Se," Currently processing: "+n(s.value.currentRecord),1)):d("",!0),s.value.successCount>0?(l(),a("div",Ee," ✓ "+n(s.value.successCount)+" employees imported successfully ",1)):d("",!0),s.value.errorCount>0?(l(),a("div",Me," ✗ "+n(s.value.errorCount)+" errors encountered ",1)):d("",!0)])])])):d("",!0),s.value.active?d("",!0):(l(),a("div",De,[e[16]||(e[16]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Upload File"),t("p",{class:"mt-1 text-sm text-gray-500"}," Select an Excel (.xlsx, .xls) or CSV file containing employee data ")],-1)),t("div",Te,[t("div",{onDrop:q,onDragover:e[1]||(e[1]=j(()=>{},["prevent"])),onDragenter:e[2]||(e[2]=j(()=>{},["prevent"])),class:oe(["border-2 border-dashed rounded-lg p-8 text-center transition-colors",M.value?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"])},[c(b(ie),{class:"mx-auto h-12 w-12 text-gray-400"}),t("div",Ie,[t("p",Pe,[e[14]||(e[14]=v(" Drop your file here, or ")),t("button",{onClick:e[0]||(e[0]=o=>r.$refs.fileInput.click()),class:"text-blue-600 hover:text-blue-500 font-medium"}," browse ")]),e[15]||(e[15]=t("p",{class:"mt-2 text-sm text-gray-500"}," Supports Excel (.xlsx, .xls) and CSV files up to 10MB ",-1))]),t("input",{ref:"fileInput",type:"file",accept:".xlsx,.xls,.csv",onChange:I,class:"hidden"},null,544)],34),i.value?(l(),a("div",Re,[t("div",Fe,[t("div",je,[c(b(ue),{class:"h-8 w-8 text-gray-400"}),t("div",null,[t("p",Ne,n(i.value.name),1),t("p",Ve,n(J(i.value.size)),1)])]),t("button",{onClick:U,class:"text-gray-400 hover:text-gray-600"},[c(b(N),{class:"h-5 w-5"})])])])):d("",!0)])])),i.value&&!s.value.active?(l(),a("div",Be,[e[28]||(e[28]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Import Options")],-1)),t("div",$e,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Column Mapping ",-1)),t("div",qe,[(l(),a(k,null,_(D,o=>t("div",{key:o.key,class:"space-y-2"},[t("label",ze,n(o.label)+" "+n(o.required?"*":""),1),f(t("select",{"onUpdate:modelValue":m=>g.value[o.key]=m,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"},[e[17]||(e[17]=t("option",{value:""},"Select column...",-1)),(l(!0),a(k,null,_(x.value,m=>(l(),a("option",{key:m,value:m},n(m),9,Ue))),128))],8,Ae),[[C,g.value[o.key]]])])),64))])]),t("div",Je,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Batch Size ",-1)),f(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>u.value.batchSize=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},e[19]||(e[19]=[t("option",{value:"10"},"10 records per batch",-1),t("option",{value:"25"},"25 records per batch",-1),t("option",{value:"50"},"50 records per batch",-1),t("option",{value:"100"},"100 records per batch",-1)]),512),[[C,u.value.batchSize]]),e[21]||(e[21]=t("p",{class:"mt-1 text-xs text-gray-500"}," Smaller batches are more reliable but slower ",-1))]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Error Handling ",-1)),f(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>u.value.errorHandling=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"},e[22]||(e[22]=[t("option",{value:"continue"},"Continue on errors",-1),t("option",{value:"stop"},"Stop on first error",-1)]),512),[[C,u.value.errorHandling]])])]),t("div",Le,[t("label",Oe,[f(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>u.value.skipFirstRow=o),type:"checkbox",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[S,u.value.skipFirstRow]]),e[24]||(e[24]=t("span",{class:"ml-2 text-sm text-gray-700"},"Skip first row (headers)",-1))]),t("label",He,[f(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>u.value.updateExisting=o),type:"checkbox",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[S,u.value.updateExisting]]),e[25]||(e[25]=t("span",{class:"ml-2 text-sm text-gray-700"},"Update existing employees (match by email)",-1))]),t("label",We,[f(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>u.value.sendWelcomeEmails=o),type:"checkbox",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[S,u.value.sendWelcomeEmails]]),e[26]||(e[26]=t("span",{class:"ml-2 text-sm text-gray-700"},"Send welcome emails to new employees",-1))])]),t("div",Qe,[t("button",{onClick:L,disabled:!T.value,class:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[c(b(me),{class:"w-5 h-5 mr-2"}),e[27]||(e[27]=v(" Start Import "))],8,Ge)])])])):d("",!0),s.value.active?d("",!0):(l(),a("div",Ke,[e[32]||(e[32]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Need a Template?")],-1)),t("div",Xe,[e[31]||(e[31]=t("p",{class:"text-sm text-gray-600 mb-4"}," Download our template file to ensure your data is formatted correctly for import. ",-1)),t("div",Ye,[t("button",{onClick:e[8]||(e[8]=o=>P("excel")),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[c(b(E),{class:"w-4 h-4 mr-2"}),e[29]||(e[29]=v(" Download Excel Template "))]),t("button",{onClick:e[9]||(e[9]=o=>P("csv")),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[c(b(E),{class:"w-4 h-4 mr-2"}),e[30]||(e[30]=v(" Download CSV Template "))])])])])),p.value?(l(),a("div",Ze,[e[38]||(e[38]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Import Results")],-1)),t("div",et,[t("div",tt,[t("div",st,[t("div",rt,n(p.value.successful),1),e[33]||(e[33]=t("div",{class:"text-sm text-gray-600"},"Successful",-1))]),t("div",ot,[t("div",lt,n(p.value.failed),1),e[34]||(e[34]=t("div",{class:"text-sm text-gray-600"},"Failed",-1))]),t("div",at,[t("div",nt,n(p.value.total),1),e[35]||(e[35]=t("div",{class:"text-sm text-gray-600"},"Total Processed",-1))])]),p.value.errors&&p.value.errors.length>0?(l(),a("div",dt,[e[36]||(e[36]=t("h4",{class:"text-sm font-medium text-gray-900 mb-3"},"Import Errors",-1)),t("div",it,[(l(!0),a(k,null,_(p.value.errors,o=>(l(),a("div",{key:o.row,class:"text-sm text-red-700 mb-2"},[t("strong",null,"Row "+n(o.row)+":",1),v(" "+n(o.message),1)]))),128))])])):d("",!0),t("div",ut,[p.value.failed>0?(l(),a("button",{key:0,onClick:X,class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},[c(b(E),{class:"w-4 h-4 mr-2"}),e[37]||(e[37]=v(" Download Error Report "))])):d("",!0),t("button",{onClick:h,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700"}," Import Another File ")])])])):d("",!0)])]),_:1})]),_:1}))}};export{kt as default};
