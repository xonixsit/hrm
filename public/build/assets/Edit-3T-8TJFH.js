import{x as j,f as w,Q as h,g as B,o as R,h as d,k as a,u as e,a as r,t as p,l as M}from"./app-IcL3AcBw.js";import{u as L}from"./useAuth-2OZ_hAux.js";import"./useNotifications-wB5ttthA.js";import{_ as J}from"./AuthenticatedLayout-yP2GqEla.js";import{P as O}from"./PageLayout-D7syRBbq.js";import{F as z,a as _}from"./FormSection-M8XtEgyb.js";import{F as u}from"./FormField-CdOH-5WG.js";import{B as y}from"./BaseInput-BGDhdXoQ.js";import{B as E}from"./BaseSelect-Zc2GlX8S.js";import{e as Q,b as H,r as W,p as G,P as K}from"./Icon-Dp6S4qi3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-DoNIRFqr.js";import"./useAccessibility-utzIDGco.js";import"./PageHeader-CJU4oQWj.js";/* empty css                                                                   *//* empty css                                                                   *//* empty css                                                                  *//* empty css                                                                   */const X={class:"bg-neutral-50 rounded-lg p-4 mb-6"},Y={class:"flex items-center space-x-4"},Z={class:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center"},ee={class:"text-lg font-semibold text-primary-700"},oe={class:"text-lg font-semibold text-neutral-900"},te={class:"text-sm text-neutral-600"},re={class:"flex items-center space-x-2 mt-1"},se={class:"text-xs font-mono bg-neutral-200 px-2 py-0.5 rounded"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={class:"bg-warning-50 border border-warning-200 rounded-lg p-4 mb-4"},ie={class:"flex items-start space-x-3"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},me={class:"flex justify-end mt-4"},pe=["disabled"],ue={class:"bg-neutral-50 rounded-lg p-4"},ce={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},ye={class:"text-neutral-600"},fe={class:"text-neutral-600"},we={class:"text-neutral-600"},ke={__name:"Edit",props:{employee:{type:Object,required:!0},departments:{type:Array,default:()=>[]},contractTypes:{type:Array,default:()=>[]}},setup(m){var v;const n=m,{hasRole:T}=L(),o=j({name:((v=n.employee.user)==null?void 0:v.name)||"",department_id:n.employee.department_id||"",job_title:n.employee.job_title||"",employee_code:n.employee.employee_code||"",join_date:n.employee.join_date?new Date(n.employee.join_date).toISOString().split("T")[0]:"",contract_type:n.employee.contract_type||""}),l=j({new_password:"",new_password_confirmation:""}),$=[{label:"Dashboard",href:route("dashboard")},{label:"Employees",href:route("employees.index")},{label:n.employee.user.name,href:route("employees.show",n.employee.id)},{label:"Edit",current:!0}],D=[{id:"view-employee",label:"View Details",icon:H,variant:"secondary",handler:()=>h.visit(route("employees.show",n.employee.id))},{id:"delete-employee",label:"Delete Employee",icon:W,variant:"danger",handler:()=>I()}],S=w(()=>[{id:"cancel",label:"Cancel",variant:"secondary",handler:()=>h.visit(route("employees.show",n.employee.id))},{id:"reset",label:"Reset Changes",variant:"ghost",handler:()=>k(),disabled:!b.value},{id:"update",label:"Update Employee",type:"submit",variant:"primary",icon:Q,loadingLabel:"Updating Employee...",disabled:!P.value||!b.value}]),P=w(()=>o.name&&o.name.trim().length>0),b=w(()=>o.name!==n.employee.user.name||o.department_id!==n.employee.department_id||o.job_title!==n.employee.job_title||o.employee_code!==n.employee.employee_code||o.join_date!==n.employee.join_date||o.contract_type!==n.employee.contract_type);w(()=>T("Admin"));const U=w(()=>l.new_password&&l.new_password.length>=8&&l.new_password===l.new_password_confirmation),F=i=>i.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().slice(0,2),x=i=>i?new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",A=i=>{if(!i)return"N/A";const t=new Date(i),N=Math.abs(new Date-t),c=Math.ceil(N/(1e3*60*60*24));if(c<30)return`${c} day${c===1?"":"s"}`;if(c<365){const f=Math.floor(c/30);return`${f} month${f===1?"":"s"}`}else{const f=Math.floor(c/365),g=Math.floor(c%365/30);let V=`${f} year${f===1?"":"s"}`;return g>0&&(V+=`, ${g} month${g===1?"":"s"}`),V}},C=()=>{o.put(route("employees.update",n.employee.id),{onSuccess:()=>{},onError:i=>{console.error("Form submission errors:",i);const t=Object.keys(i)[0];if(t){const s=document.querySelector(`[name="${t}"]`);s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),s.focus())}}})},k=()=>{confirm("Are you sure you want to reset all changes? This action cannot be undone.")&&(o.reset(),o.clearErrors())},q=()=>{confirm(`Are you sure you want to reset the password for ${n.employee.user.name}? They will need to use the new password to log in.`)&&l.post(route("employees.reset-password",n.employee.id),{onSuccess:()=>{l.reset(),l.clearErrors(),console.log("Password reset successfully")},onError:i=>{console.error("Password reset errors:",i);const t=Object.keys(i)[0];if(t){const s=document.querySelector(`input[name="${t}"]`);s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),s.focus())}}})},I=()=>{confirm(`Are you sure you want to delete ${n.employee.user.name}? This action cannot be undone.`)&&h.delete(route("employees.destroy",n.employee.id),{onSuccess:()=>{h.visit(route("employees.index"))},onError:()=>{alert("Failed to delete employee. Please try again.")}})};return(i,t)=>(R(),B(J,null,{default:d(()=>[a(O,{title:`Edit Employee: ${m.employee.user.name}`,subtitle:"Update employee information and employment details",breadcrumbs:$,actions:D},{default:d(()=>[a(z,{title:"Employee Information",description:"Update the employee's information below",actions:S.value,errors:e(o).errors,"is-submitting":e(o).processing,variant:"card",onSubmit:C},{default:d(()=>[r("div",X,[r("div",Y,[r("div",Z,[r("span",ee,p(F(m.employee.user.name)),1)]),r("div",null,[r("h3",oe,p(m.employee.user.name),1),r("p",te,p(m.employee.user.email),1),r("div",re,[t[9]||(t[9]=r("span",{class:"text-xs text-neutral-500"},"Employee ID:",-1)),r("span",se,p(m.employee.employee_code||"N/A"),1)])])])]),a(_,{title:"Personal Information",description:"Basic personal details of the employee"},{default:d(()=>[r("div",ae,[a(u,{label:"Full Name",required:"",error:e(o).errors.name,help:"Employee's full name as it appears on official documents"},{default:d(()=>[a(y,{modelValue:e(o).name,"onUpdate:modelValue":t[0]||(t[0]=s=>e(o).name=s),type:"text",placeholder:"John Doe",error:!!e(o).errors.name,required:""},null,8,["modelValue","error"])]),_:1},8,["error"]),a(u,{label:"Employee Code",error:e(o).errors.employee_code,help:"Unique identifier for the employee"},{default:d(()=>[a(y,{modelValue:e(o).employee_code,"onUpdate:modelValue":t[1]||(t[1]=s=>e(o).employee_code=s),type:"text",placeholder:"EMP001",error:!!e(o).errors.employee_code},null,8,["modelValue","error"])]),_:1},8,["error"])])]),_:1}),a(_,{title:"Employment Details",description:"Job-related information and organizational structure"},{default:d(()=>[r("div",ne,[a(u,{label:"Job Title",error:e(o).errors.job_title,help:"The employee's position or role in the organization"},{default:d(()=>[a(y,{modelValue:e(o).job_title,"onUpdate:modelValue":t[2]||(t[2]=s=>e(o).job_title=s),type:"text",placeholder:"Software Developer",error:!!e(o).errors.job_title},null,8,["modelValue","error"])]),_:1},8,["error"]),a(u,{label:"Department",error:e(o).errors.department_id,help:"Select the department this employee belongs to"},{default:d(()=>[a(E,{modelValue:e(o).department_id,"onUpdate:modelValue":t[3]||(t[3]=s=>e(o).department_id=s),options:m.departments,"option-label":"name","option-value":"id",placeholder:"Select department","error-message":e(o).errors.department_id},null,8,["modelValue","options","error-message"])]),_:1},8,["error"]),a(u,{label:"Join Date",error:e(o).errors.join_date,help:"The date when the employee started working"},{default:d(()=>[a(y,{modelValue:e(o).join_date,"onUpdate:modelValue":t[4]||(t[4]=s=>e(o).join_date=s),type:"date",error:!!e(o).errors.join_date,value:e(o).join_date,onInput:t[5]||(t[5]=s=>e(o).join_date=s.target.value)},null,8,["modelValue","error","value"])]),_:1},8,["error"]),a(u,{label:"Contract Type",error:e(o).errors.contract_type,help:"Type of employment contract"},{default:d(()=>[a(E,{modelValue:e(o).contract_type,"onUpdate:modelValue":t[6]||(t[6]=s=>e(o).contract_type=s),options:m.contractTypes,error:!!e(o).errors.contract_type,placeholder:"Select contract type",class:"asolute"},null,8,["modelValue","options","error"])]),_:1},8,["error"])]),r("div",le,[r("div",ie,[a(e(G),{class:"w-5 h-5 text-warning-600 mt-0.5 flex-shrink-0"}),t[10]||(t[10]=r("div",null,[r("h4",{class:"text-sm font-medium text-warning-800"},"Password Reset"),r("p",{class:"text-sm text-warning-700 mt-1"}," This will immediately change the employee's password. They will need to use the new password to log in. ")],-1))])]),r("div",de,[a(u,{label:"New Password",required:"",error:e(l).errors.new_password,help:"Password must be at least 8 characters long"},{default:d(()=>[a(y,{modelValue:e(l).new_password,"onUpdate:modelValue":t[7]||(t[7]=s=>e(l).new_password=s),type:"password",placeholder:"Enter new password",error:!!e(l).errors.new_password,required:""},null,8,["modelValue","error"])]),_:1},8,["error"]),a(u,{label:"Confirm New Password",required:"",error:e(l).errors.new_password_confirmation,help:"Re-enter the new password to confirm"},{default:d(()=>[a(y,{modelValue:e(l).new_password_confirmation,"onUpdate:modelValue":t[8]||(t[8]=s=>e(l).new_password_confirmation=s),type:"password",placeholder:"Confirm new password",error:!!e(l).errors.new_password_confirmation,required:""},null,8,["modelValue","error"])]),_:1},8,["error"])]),r("div",me,[r("button",{onClick:q,disabled:!U.value||e(l).processing,class:"inline-flex items-center px-4 py-2 bg-warning-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-warning-700 focus:bg-warning-700 active:bg-warning-900 focus:outline-none focus:ring-2 focus:ring-warning-500 focus:ring-offset-2 transition ease-in-out duration-150 disabled:opacity-50 disabled:cursor-not-allowed"},[a(e(K),{class:"w-4 h-4 mr-2"}),M(" "+p(e(l).processing?"Resetting Password...":"Reset Password"),1)],8,pe)])]),_:1}),a(_,{title:"Employment History",description:"Track changes and important dates"},{default:d(()=>[r("div",ue,[r("div",ce,[r("div",null,[t[11]||(t[11]=r("span",{class:"font-medium text-neutral-700"},"Created:",-1)),r("p",ye,p(x(m.employee.created_at)),1)]),r("div",null,[t[12]||(t[12]=r("span",{class:"font-medium text-neutral-700"},"Last Updated:",-1)),r("p",fe,p(x(m.employee.updated_at)),1)]),r("div",null,[t[13]||(t[13]=r("span",{class:"font-medium text-neutral-700"},"Time with Company:",-1)),r("p",we,p(A(m.employee.join_date)),1)])])])]),_:1})]),_:1},8,["actions","errors","is-submitting"])]),_:1},8,["title"])]),_:1}))}};export{ke as default};
