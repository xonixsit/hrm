import{U as H,x as F,e as j,f as _,z as R,g as $,o as l,h,a as e,k as v,u as s,S as y,l as i,t as d,n as f,c as a,i as c,d as O,w as g,F as A,r as B,v as C,b as z,G as D,Q as P}from"./app-C51Ifso5.js";import{_ as Q}from"./AuthenticatedLayout-NyF5khB_.js";import{b as W}from"./Icon-BhRYfepf.js";import"./useAuth-Blxfr8Ck.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-DITUjXc-.js";import"./useAccessibility-CdeKpcWR.js";const q={class:"min-h-screen bg-gray-50"},G={class:"bg-white border-b border-gray-200"},I={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Y={class:"py-6"},J={class:"flex mb-4","aria-label":"Breadcrumb"},K={class:"flex items-center space-x-2 text-sm"},X={class:"flex items-center"},Z={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},ee={class:"mb-4 sm:mb-0"},te={class:"mt-1 text-sm text-gray-600"},se={class:"flex items-center space-x-3"},oe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},re={class:"bg-white rounded-lg shadow-sm border border-gray-200"},le={class:"p-8"},ae={class:"flex"},de={class:"flex-shrink-0"},ne={key:0,class:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20"},ie={key:1,class:"h-5 w-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20"},ue={class:"ml-3"},me={key:0},ce={key:1},pe=["disabled"],fe=["value"],xe={key:0,class:"mt-1 text-sm text-red-600"},be=["disabled"],he=["value"],ve={key:0,class:"mt-1 text-sm text-red-600"},ge=["disabled"],ye={key:0,class:"mt-1 text-sm text-red-600"},we=["disabled"],ke={key:0,class:"mt-1 text-sm text-red-600"},_e=["disabled"],Ce={key:0,class:"mt-1 text-sm text-red-600"},ze={key:0,class:"border-t border-gray-200 pt-6"},Me={class:"border-t border-gray-200 pt-6"},je={key:0,class:"bg-blue-50 p-4 rounded-md"},Ae={class:"flex items-start"},Be={class:"ml-3 flex-1"},De={class:"mt-2 text-sm text-blue-700"},Ve={key:0},Se={key:0,class:"mt-3"},Te={class:"flex items-center justify-between"},Le={class:"text-sm text-amber-700"},Ue=["disabled"],Ne={key:0,class:"animate-spin -ml-1 mr-1 h-3 w-3 text-white",fill:"none",viewBox:"0 0 24 24"},Ee={key:1,class:"mt-2"},He={key:1,class:"bg-yellow-50 p-4 rounded-md"},Fe={key:2,class:"bg-gray-50 p-4 rounded-md"},Re={key:1,class:"bg-gray-50 p-4 rounded-md"},$e={class:"text-sm text-gray-700"},Oe={key:0,class:"text-xs text-gray-500 mt-2"},Pe={class:"flex items-center justify-between pt-6 border-t border-gray-200"},Qe={class:"flex items-center space-x-3"},We={class:"flex items-center space-x-3"},qe=["disabled"],Ge={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},tt={__name:"Edit",props:{timesheet:Object,projects:Array,tasks:Array},setup(u){const p=u,w=H(),o=F({project_id:p.timesheet.project_id,task_id:p.timesheet.task_id||"",date:p.timesheet.date,hours:p.timesheet.hours,description:p.timesheet.description||"",status:p.timesheet.status}),m=j({}),x=j(!1),b=_(()=>{var r;return p.timesheet.status==="pending"||((r=w.props.auth.user.roles)==null?void 0:r.some(t=>["Admin","Manager"].includes(t.name)))}),M=_(()=>{var r;return(r=w.props.auth.user.roles)==null?void 0:r.some(t=>["Admin","Manager"].includes(t.name))}),V=_(()=>{var r;return p.timesheet.status==="pending"||((r=w.props.auth.user.roles)==null?void 0:r.some(t=>["Admin","Manager"].includes(t.name)))}),S=()=>{o.put(route("timesheets.update",p.timesheet.id),{onSuccess:()=>{}})},T=()=>{confirm("Are you sure you want to delete this timesheet entry? This action cannot be undone.")&&P.delete(route("timesheets.destroy",p.timesheet.id))},L=r=>{const t="inline-flex px-3 py-1 text-sm font-semibold rounded-full";switch(r){case"approved":return`${t} bg-green-100 text-green-800`;case"rejected":return`${t} bg-red-100 text-red-800`;case"pending":default:return`${t} bg-yellow-100 text-yellow-800`}},U=r=>new Date(r).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),N=r=>new Date(r).toLocaleString(),k=async()=>{try{const r=await D.get(route("timesheets.attendance-data",p.timesheet.id));m.value=r.data}catch(r){console.error("Failed to load attendance data:",r),m.value={has_attendance:!1,message:"Failed to load attendance data"}}},E=async()=>{if(!x.value){x.value=!0;try{const r=await D.post(route("timesheets.sync-attendance",p.timesheet.id));r.data.success&&(o.hours=r.data.timesheet.hours,o.description=r.data.timesheet.description,await k(),alert("Timesheet synchronized with attendance data successfully!"))}catch(r){console.error("Failed to sync with attendance:",r),alert("Failed to sync with attendance data. Please try again.")}finally{x.value=!1}}};return R(()=>{k()}),(r,t)=>(l(),$(Q,null,{default:h(()=>[e("div",q,[e("div",G,[e("div",I,[e("div",Y,[e("nav",J,[e("ol",K,[e("li",null,[v(s(y),{href:r.route("dashboard"),class:"text-gray-500 hover:text-gray-700 transition-colors"},{default:h(()=>t[6]||(t[6]=[i(" Dashboard ")])),_:1,__:[6]},8,["href"])]),e("li",X,[t[8]||(t[8]=e("svg",{class:"w-4 h-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),v(s(y),{href:r.route("timesheets.index"),class:"text-gray-500 hover:text-gray-700 transition-colors"},{default:h(()=>t[7]||(t[7]=[i(" Timesheets ")])),_:1,__:[7]},8,["href"])]),t[9]||(t[9]=e("li",{class:"flex items-center"},[e("svg",{class:"w-4 h-4 text-gray-400 mx-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})]),e("span",{class:"text-gray-900 font-medium"},"Edit Entry")],-1))])]),e("div",Z,[e("div",ee,[t[10]||(t[10]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Edit Timesheet Entry",-1)),e("p",te," Update your time entry for "+d(U(u.timesheet.date)),1)]),e("div",se,[e("span",{class:f([L(u.timesheet.status),"inline-flex px-3 py-1 text-sm font-semibold rounded-full"])},d(u.timesheet.status),3),v(s(y),{href:r.route("timesheets.show",u.timesheet.id),class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"},{default:h(()=>[v(s(W),{class:"w-4 h-4 mr-2"}),t[11]||(t[11]=i(" View Details "))]),_:1,__:[11]},8,["href"])])])])])]),e("div",oe,[e("div",re,[e("div",le,[u.timesheet.status!=="pending"?(l(),a("div",{key:0,class:f(["mb-6 p-4 rounded-md",u.timesheet.status==="approved"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"])},[e("div",ae,[e("div",de,[u.timesheet.status==="approved"?(l(),a("svg",ne,t[12]||(t[12]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):(l(),a("svg",ie,t[13]||(t[13]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)])))]),e("div",ue,[e("p",{class:f(["text-sm",u.timesheet.status==="approved"?"text-green-800":"text-red-800"])},[i(" This timesheet has been "+d(u.timesheet.status)+". ",1),u.timesheet.status==="approved"?(l(),a("span",me,"Changes may require re-approval.")):(l(),a("span",ce,"You can edit and resubmit for approval."))],2)])])],2)):c("",!0),e("form",{onSubmit:O(S,["prevent"]),class:"space-y-6"},[e("div",null,[t[15]||(t[15]=e("label",{for:"project_id",class:"block text-sm font-medium text-gray-700"},[i(" Project "),e("span",{class:"text-red-500"},"*")],-1)),g(e("select",{id:"project_id","onUpdate:modelValue":t[0]||(t[0]=n=>s(o).project_id=n),class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":s(o).errors.project_id}]),disabled:!b.value},[t[14]||(t[14]=e("option",{value:""},"Select a project",-1)),(l(!0),a(A,null,B(u.projects,n=>(l(),a("option",{key:n.id,value:n.id},d(n.name),9,fe))),128))],10,pe),[[C,s(o).project_id]]),s(o).errors.project_id?(l(),a("div",xe,d(s(o).errors.project_id),1)):c("",!0)]),e("div",null,[t[17]||(t[17]=e("label",{for:"task_id",class:"block text-sm font-medium text-gray-700"}," Task (Optional) ",-1)),g(e("select",{id:"task_id","onUpdate:modelValue":t[1]||(t[1]=n=>s(o).task_id=n),class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":s(o).errors.task_id}]),disabled:!b.value},[t[16]||(t[16]=e("option",{value:""},"No specific task",-1)),(l(!0),a(A,null,B(u.tasks,n=>(l(),a("option",{key:n.id,value:n.id},d(n.name),9,he))),128))],10,be),[[C,s(o).task_id]]),s(o).errors.task_id?(l(),a("div",ve,d(s(o).errors.task_id),1)):c("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{for:"date",class:"block text-sm font-medium text-gray-700"},[i(" Date "),e("span",{class:"text-red-500"},"*")],-1)),g(e("input",{id:"date","onUpdate:modelValue":t[2]||(t[2]=n=>s(o).date=n),type:"date",class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":s(o).errors.date}]),disabled:!b.value},null,10,ge),[[z,s(o).date]]),s(o).errors.date?(l(),a("div",ye,d(s(o).errors.date),1)):c("",!0)]),e("div",null,[t[19]||(t[19]=e("label",{for:"hours",class:"block text-sm font-medium text-gray-700"},[i(" Hours "),e("span",{class:"text-red-500"},"*")],-1)),g(e("input",{id:"hours","onUpdate:modelValue":t[3]||(t[3]=n=>s(o).hours=n),type:"number",step:"0.25",min:"0",max:"24",class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":s(o).errors.hours}]),placeholder:"e.g., 8.5",disabled:!b.value},null,10,we),[[z,s(o).hours]]),s(o).errors.hours?(l(),a("div",ke,d(s(o).errors.hours),1)):c("",!0),t[20]||(t[20]=e("p",{class:"mt-1 text-sm text-gray-500"}," Enter hours in decimal format (e.g., 8.5 for 8 hours 30 minutes) ",-1))]),e("div",null,[t[21]||(t[21]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700"}," Description ",-1)),g(e("textarea",{id:"description","onUpdate:modelValue":t[4]||(t[4]=n=>s(o).description=n),rows:"4",class:f(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"border-red-300":s(o).errors.description}]),placeholder:"Describe the work performed...",disabled:!b.value},null,10,_e),[[z,s(o).description]]),s(o).errors.description?(l(),a("div",Ce,d(s(o).errors.description),1)):c("",!0)]),M.value?(l(),a("div",ze,[t[23]||(t[23]=e("label",{for:"status",class:"block text-sm font-medium text-gray-700"}," Status ",-1)),g(e("select",{id:"status","onUpdate:modelValue":t[5]||(t[5]=n=>s(o).status=n),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},t[22]||(t[22]=[e("option",{value:"pending"},"Pending",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1)]),512),[[C,s(o).status]]),t[24]||(t[24]=e("p",{class:"mt-1 text-sm text-gray-500"}," Change the approval status of this timesheet entry ",-1))])):c("",!0),e("div",Me,[e("div",{class:"flex items-center justify-between mb-4"},[t[26]||(t[26]=e("h4",{class:"text-sm font-medium text-gray-900"},"Attendance Synchronization",-1)),e("button",{onClick:k,type:"button",class:"inline-flex items-center px-3 py-1 text-xs font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition-colors"},t[25]||(t[25]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),i(" Refresh ")]))]),m.value.has_attendance?(l(),a("div",je,[e("div",Ae,[t[36]||(t[36]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",Be,[t[35]||(t[35]=e("h5",{class:"text-sm font-medium text-blue-800"},"Attendance Record Found",-1)),e("div",De,[e("p",null,[t[27]||(t[27]=e("strong",null,"Clock In:",-1)),i(" "+d(m.value.attendance.clock_in||"Not clocked in"),1)]),e("p",null,[t[28]||(t[28]=e("strong",null,"Clock Out:",-1)),i(" "+d(m.value.attendance.clock_out||"Not clocked out"),1)]),e("p",null,[t[29]||(t[29]=e("strong",null,"Work Duration:",-1)),i(" "+d(m.value.attendance.work_duration),1)]),e("p",null,[t[30]||(t[30]=e("strong",null,"Calculated Hours:",-1)),i(" "+d(m.value.attendance.calculated_hours)+"h",1)]),m.value.attendance.break_sessions>0?(l(),a("p",Ve,[t[31]||(t[31]=e("strong",null,"Break Time:",-1)),i(" "+d(m.value.attendance.break_duration)+" ("+d(m.value.attendance.break_sessions)+" session"+d(m.value.attendance.break_sessions>1?"s":"")+") ",1)])):c("",!0)]),m.value.sync_needed?(l(),a("div",Se,[e("div",Te,[e("p",Le,[t[32]||(t[32]=e("svg",{class:"w-4 h-4 inline mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),i(" Hours mismatch detected (Timesheet: "+d(s(o).hours)+"h, Attendance: "+d(m.value.attendance.calculated_hours)+"h) ",1)]),e("button",{onClick:E,type:"button",disabled:x.value,class:"inline-flex items-center px-3 py-1 text-xs font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors"},[x.value?(l(),a("svg",Ne,t[33]||(t[33]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):c("",!0),i(" "+d(x.value?"Syncing...":"Sync Now"),1)],8,Ue)])])):(l(),a("div",Ee,t[34]||(t[34]=[e("p",{class:"text-sm text-green-700"},[e("svg",{class:"w-4 h-4 inline mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),i(" Timesheet is synchronized with attendance data ")],-1)])))])])])):m.value.has_attendance===!1?(l(),a("div",He,t[37]||(t[37]=[e("div",{class:"flex"},[e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),e("div",{class:"ml-3"},[e("h5",{class:"text-sm font-medium text-yellow-800"},"No Attendance Record"),e("p",{class:"text-sm text-yellow-700 mt-1"}," No attendance record found for this date. This timesheet was created manually. ")])],-1)]))):(l(),a("div",Fe,t[38]||(t[38]=[e("p",{class:"text-sm text-gray-600"},'Click "Refresh" to check for attendance data.',-1)])))]),u.timesheet.approval_comments?(l(),a("div",Re,[t[39]||(t[39]=e("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"Approval Comments",-1)),e("p",$e,d(u.timesheet.approval_comments),1),u.timesheet.approved_at?(l(),a("p",Oe,d(N(u.timesheet.approved_at)),1)):c("",!0)])):c("",!0),e("div",Pe,[e("div",Qe,[v(s(y),{href:r.route("timesheets.index"),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:h(()=>t[40]||(t[40]=[i(" Back to List ")])),_:1,__:[40]},8,["href"]),v(s(y),{href:r.route("timesheets.show",u.timesheet.id),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:h(()=>t[41]||(t[41]=[i(" View Details ")])),_:1,__:[41]},8,["href"])]),e("div",We,[V.value?(l(),a("button",{key:0,type:"button",onClick:T,class:"inline-flex items-center px-4 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," Delete ")):c("",!0),b.value||M.value?(l(),a("button",{key:1,type:"submit",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",disabled:s(o).processing},[s(o).processing?(l(),a("svg",Ge,t[42]||(t[42]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):c("",!0),i(" "+d(s(o).processing?"Updating...":"Update Entry"),1)],8,qe)):c("",!0)])])],32)])])])])]),_:1}))}};export{tt as default};
