import{c as k,o as f,a as t,f as u,e as C,Q as w,z as it,g as M,h as m,k as c,i as I,t as a,u as b,w as j,b as B,l as lt,F as ct,r as dt,G as ut}from"./app-xdepanHZ.js";import{u as mt}from"./useAuth-CudXQfIQ.js";import{a as N,A as ft}from"./AuthenticatedLayout-CZ0OVhuW.js";import{P as gt}from"./PageLayout-BccGU9d8.js";import{C as v}from"./ContentCard-ub4Xvda9.js";import{S as _}from"./StatsCard-CktZsFkK.js";import{n as xt,m as E}from"./icons-CUGySb-c.js";import{b as bt}from"./UsersIcon-BJjAwH1y.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./PageHeader.vue_vue_type_style_index_0_scoped_4a3d46e5_lang-JUDLfduY.js";import"./PageHeader-D4dPJfLU.js";import"./Icon-PSXnjYiR.js";/* empty css                                                                   *//* empty css                                                                  */import"./ArrowTrendingUpIcon-Ci8QpvWr.js";import"./ArrowTrendingDownIcon-DkLMuwqH.js";import"./ArrowTopRightOnSquareIcon-Bk4vIHFJ.js";import"./ChartBarIcon-CdLOxGra.js";function kt(o,n){return f(),k("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75"})])}function ht(o,n){return f(),k("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})])}const yt={class:"space-y-8"},vt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6"},pt={class:"text-xs text-gray-500 mt-1"},wt={class:"text-xs text-gray-500 mt-1"},_t={class:"text-xs text-gray-500 mt-1"},Dt={class:"text-xs text-gray-500 mt-1"},St={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8"},Ct={class:"space-y-1"},Mt={class:"flex justify-between items-center py-3 px-4 bg-gray-50 rounded-lg"},At={class:"flex items-center space-x-2"},Tt={class:"text-sm font-semibold text-gray-900"},$t={class:"flex justify-between items-center py-3 px-4 bg-green-50 rounded-lg"},Ot={class:"flex items-center space-x-2"},It={class:"text-sm font-semibold text-green-900"},jt={class:"flex justify-between items-center py-3 px-4 bg-red-50 rounded-lg"},Bt={class:"flex items-center space-x-2"},Nt={class:"text-sm font-semibold text-red-900"},Et={class:"flex justify-between items-center py-3 px-4 bg-blue-50 rounded-lg border-2 border-blue-200"},Vt={class:"flex items-center space-x-2"},Lt={class:"text-lg font-bold text-blue-900"},Rt={class:"space-y-4"},Ft={class:"p-4 bg-amber-50 border border-amber-200 rounded-lg"},Ut={class:"flex items-start space-x-2"},Ht={class:"space-y-4"},Pt=["min","max"],zt={class:"mt-1 text-xs text-gray-500"},Wt={class:"flex items-center justify-end space-x-3"},qt=["disabled"],Qt={key:0,class:"flex items-center"},Yt={key:1},Gt={key:0,class:"text-center py-12"},Zt={key:1,class:"space-y-3"},Jt={class:"p-4 bg-gradient-to-r from-orange-100 to-orange-50 rounded-lg border-2 border-orange-300 mb-4"},Kt={class:"flex justify-between items-center"},Xt={class:"flex items-center space-x-2"},te={class:"text-lg font-bold text-orange-900"},ee={class:"text-xs text-orange-700 mt-1"},se={class:"flex items-center space-x-3"},ne={class:"w-8 h-8 bg-orange-200 rounded-full flex items-center justify-center"},oe={class:"text-xs font-bold text-orange-700"},ae={class:"text-sm font-semibold text-orange-900"},re={class:"text-xs text-orange-700"},ie={class:"text-right"},le={class:"text-sm font-medium text-neutral-900"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},de={class:"space-y-4"},ue={class:"flex justify-between items-center py-2 border-b border-neutral-200"},me={class:"text-sm text-neutral-900"},fe={class:"flex justify-between items-center py-2 border-b border-neutral-200"},ge={class:"text-sm text-neutral-900"},xe={class:"flex justify-between items-center py-2"},be={class:"text-sm text-neutral-900"},ke={class:"space-y-4"},he={class:"flex justify-between items-center py-2 border-b border-neutral-200"},ye={class:"text-sm text-neutral-900"},ve={class:"flex justify-between items-center py-2 border-b border-neutral-200"},pe={class:"text-sm text-neutral-900"},we={class:"flex justify-between items-center py-2"},_e={class:"text-sm text-neutral-900"},De={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},Se={class:"flex items-center space-x-2"},Ce={class:"text-sm text-yellow-700"},We={__name:"Show",props:{attendance:Object,workDuration:String,breakDuration:String,totalMinutes:Number,breakSessions:Array},setup(o){const n=o,{user:V,hasRole:L,hasAnyRole:R}=mt(),A=u(()=>R(["Admin","HR"])),h=C(""),y=C(""),p=C(!1),F=u(()=>{var l,r;const s=((r=(l=V.value)==null?void 0:l.employee)==null?void 0:r.id)===n.attendance.employee_id,e=A.value||s,i=!n.attendance.clock_out&&n.attendance.status!=="clocked_out";return e&&i}),T=u(()=>h.value&&y.value.trim().length>=10),U=u(()=>[{label:"Dashboard",href:route("dashboard")},{label:"Attendance Management",href:route("attendances.index")},{label:"Details",current:!0}]),H=u(()=>{const s=[];return A.value&&s.push({id:"edit",label:"Edit Record",variant:"primary",handler:()=>w.visit(route("attendances.edit",n.attendance.id))},{id:"export",label:"Export",variant:"secondary",handler:()=>window.open(route("attendances.export",n.attendance.id),"_blank")}),L("Admin")&&s.push({id:"delete",label:"Delete",variant:"danger",handler:X}),s}),$=s=>s?new Date(s+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A",x=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"America/Los_Angeles"})}catch(e){return console.error("Error formatting time:",e),"N/A"}},D=s=>s?new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):"N/A",P=s=>({clocked_in:"Clocked In",clocked_out:"Clocked Out",on_break:"On Break"})[s]||s,z=s=>({clocked_in:"success",clocked_out:"secondary",on_break:"warning"})[s]||"secondary",W=u(()=>{if(!n.workDuration||n.workDuration==="0h 0m")return"0 hours";if(n.workDuration&&n.workDuration.includes("h"))return n.workDuration;const s=parseInt(n.workDuration);return isNaN(s)?"0 hours":`${s}h 0m`}),q=u(()=>{if(!n.attendance.clock_in)return"No clock in recorded";const s=x(n.attendance.clock_in),e=n.attendance.clock_out?x(n.attendance.clock_out):"Still working";return`${s} - ${e}`}),Q=u(()=>!n.breakDuration||n.breakDuration==="-"||n.breakDuration==="0h 0m"?"0 minutes":(n.breakDuration&&(n.breakDuration.includes("h")||n.breakDuration.includes("m")),n.breakDuration)),Y=u(()=>{const s=n.breakSessions.length;return s===0?"No breaks taken":s===1?"1 break session":`${s} break sessions`}),G=u(()=>{const s=n.breakSessions.length;return s===0?"Continuous work":s===1?"Single break taken":"Multiple breaks"}),Z=u(()=>{switch(n.attendance.status){case"clocked_in":return n.attendance.clock_in?`Since ${x(n.attendance.clock_in)}`:"Currently working";case"clocked_out":return n.attendance.clock_out?`At ${x(n.attendance.clock_out)}`:"Work completed";case"on_break":return"Currently on break";default:return"Status unknown"}}),J=s=>{if(!s.start||!s.end)return"—";try{const e=new Date(s.start),l=new Date(s.end)-e,r=Math.floor(l/(1e3*60)),d=Math.floor(r/60),g=r%60;return d>0?`${d}h ${g}m`:`${g}m`}catch(e){return console.error("Error calculating break duration:",e),"—"}},K=u(()=>{if(!n.breakSessions||n.breakSessions.length===0)return"0m";let s=0;n.breakSessions.forEach(l=>{if(l.start&&l.end)try{const r=new Date(l.start),g=new Date(l.end)-r,S=Math.floor(g/(1e3*60));s+=S}catch(r){console.error("Error calculating break duration for session:",l,r)}});const e=Math.floor(s/60),i=s%60;return e>0?`${e}h ${i}m`:`${i}m`}),X=()=>{confirm("Are you sure you want to delete this attendance record? This action cannot be undone.")&&w.delete(route("attendances.destroy",n.attendance.id),{onSuccess:()=>{w.visit(route("attendances.index"))}})},tt=()=>{var s;if(!((s=n.attendance)!=null&&s.clock_in))return"";try{const e=new Date(n.attendance.clock_in);return e.setMinutes(e.getMinutes()+1),e.toISOString().slice(0,16)}catch{return""}},et=()=>{var i;const s=(i=n.attendance)==null?void 0:i.date;return s?`${s}T23:59`:new Date().toISOString().slice(0,16)},O=()=>{var l,r;const s=(l=n.attendance)==null?void 0:l.date;if(!s){h.value=new Date().toISOString().slice(0,16),y.value="";return}const e=s;let i;if((r=n.attendance)!=null&&r.clock_in)try{const d=new Date(n.attendance.clock_in),g=new Date(d.getTime()+8*60*60*1e3),S=g.getFullYear(),nt=String(g.getMonth()+1).padStart(2,"0"),ot=String(g.getDate()).padStart(2,"0"),at=String(g.getHours()).padStart(2,"0"),rt=String(g.getMinutes()).padStart(2,"0");i=`${S}-${nt}-${ot}T${at}:${rt}`}catch(d){console.error("Error calculating default clock out time:",d),i=`${e}T18:00`}else i=`${e}T18:00`;h.value=i,y.value=""},st=async()=>{var s,e;if(T.value){p.value=!0;try{const i=await ut.post(route("attendances.manual-clock-out"),{attendance_id:n.attendance.id,clock_out_time:h.value,reason:y.value.trim()});i.data.success?w.visit(route("attendances.show",n.attendance.id),{onSuccess:()=>{alert("Employee clocked out successfully!")}}):alert(i.data.message||"Failed to clock out")}catch(i){console.error("Clock out error:",i),alert(((e=(s=i.response)==null?void 0:s.data)==null?void 0:e.message)||"An error occurred while clocking out")}finally{p.value=!1}}};return it(()=>{O()}),(s,e)=>(f(),M(ft,null,{default:m(()=>{var i,l;return[c(gt,{title:"Attendance Details",subtitle:`${((l=(i=o.attendance.employee)==null?void 0:i.user)==null?void 0:l.name)||"Employee"} - ${$(o.attendance.date)}`,breadcrumbs:U.value,actions:H.value},{default:m(()=>[t("div",yt,[t("div",vt,[c(_,{label:"Work Duration",value:W.value,format:"text",icon:"ClockIcon",iconColor:"info",class:"transform hover:scale-105 transition-transform duration-200"},{default:m(()=>[t("div",pt,a(q.value),1)]),_:1},8,["value"]),c(_,{label:"Break Duration",value:Q.value,format:"text",icon:"PauseIcon",iconColor:"warning",class:"transform hover:scale-105 transition-transform duration-200"},{default:m(()=>[t("div",wt,a(Y.value),1)]),_:1},8,["value"]),c(_,{label:"Break Sessions",value:o.breakSessions.length.toString(),icon:"ListBulletIcon",iconColor:"success",class:"transform hover:scale-105 transition-transform duration-200"},{default:m(()=>[t("div",_t,a(G.value),1)]),_:1},8,["value"]),c(_,{label:"Status",value:P(o.attendance.status),icon:"CheckCircleIcon",iconColor:z(o.attendance.status),class:"transform hover:scale-105 transition-transform duration-200"},{default:m(()=>[t("div",Dt,a(Z.value),1)]),_:1},8,["value","iconColor"])]),t("div",St,[c(v,{title:"Time Details",class:"shadow-sm hover:shadow-md transition-shadow duration-200"},{default:m(()=>[t("div",Ct,[t("div",Mt,[t("div",At,[c(b(xt),{class:"w-4 h-4 text-gray-500"}),e[2]||(e[2]=t("span",{class:"text-sm font-medium text-gray-700"},"Date",-1))]),t("span",Tt,a($(o.attendance.date)),1)]),t("div",$t,[t("div",Ot,[c(b(ht),{class:"w-4 h-4 text-green-600"}),e[3]||(e[3]=t("span",{class:"text-sm font-medium text-green-700"},"Clock In",-1))]),t("span",It,a(o.attendance.clock_in?x(o.attendance.clock_in):"—"),1)]),t("div",jt,[t("div",Bt,[c(b(kt),{class:"w-4 h-4 text-red-600"}),e[4]||(e[4]=t("span",{class:"text-sm font-medium text-red-700"},"Clock Out",-1))]),t("span",Nt,a(o.attendance.clock_out?x(o.attendance.clock_out):"—"),1)]),t("div",Et,[t("div",Vt,[c(b(bt),{class:"w-4 h-4 text-blue-600"}),e[5]||(e[5]=t("span",{class:"text-sm font-medium text-blue-700"},"Total Work Time",-1))]),t("span",Lt,a(o.workDuration||"0h 0m"),1)])])]),_:1}),F.value?(f(),M(v,{key:0,title:"Manual Clock Out",class:"shadow-sm hover:shadow-md transition-shadow duration-200 border-orange-200 bg-orange-50"},{default:m(()=>[t("div",Rt,[t("div",Ft,[t("div",Ut,[c(b(E),{class:"w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0"}),e[6]||(e[6]=t("div",null,[t("p",{class:"text-sm font-medium text-amber-800"},"Manual Clock Out Required"),t("p",{class:"text-xs text-amber-700 mt-1"}," This employee is still clocked in. You can manually clock them out by setting the clock out time below. ")],-1))])]),t("div",Ht,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Clock Out Time ",-1)),j(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>h.value=r),type:"datetime-local",min:tt(),max:et(),class:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:""},null,8,Pt),[[B,h.value]]),t("p",zt," Must be after clock-in time ("+a(x(o.attendance.clock_in))+") and not in the future. ",1)]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Reason for Manual Clock Out ",-1)),j(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=r=>y.value=r),rows:"3",placeholder:"Please provide a reason for the manual clock out (e.g., forgot to clock out, system issue, etc.)",class:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm resize-none",required:""},null,512),[[B,y.value]])]),t("div",Wt,[t("button",{onClick:O,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"}," Reset "),t("button",{onClick:st,disabled:!T.value||p.value,class:"px-4 py-2 text-sm font-medium text-white bg-orange-600 border border-transparent rounded-lg hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[p.value?(f(),k("span",Qt,e[9]||(e[9]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),lt(" Processing... ")]))):(f(),k("span",Yt,"Clock Out Employee"))],8,qt)])])])]),_:1})):I("",!0),c(v,{title:"Break Sessions",class:"shadow-sm hover:shadow-md transition-shadow duration-200"},{default:m(()=>[o.breakSessions.length===0?(f(),k("div",Gt,[c(b(N),{class:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e[10]||(e[10]=t("p",{class:"text-gray-500 font-medium"},"No break sessions recorded",-1)),e[11]||(e[11]=t("p",{class:"text-sm text-gray-400 mt-1"},"All work time was continuous",-1))])):(f(),k("div",Zt,[t("div",Jt,[t("div",Kt,[t("div",Xt,[c(b(N),{class:"w-5 h-5 text-orange-600"}),e[12]||(e[12]=t("span",{class:"text-sm font-semibold text-orange-900"},"Total Break Time",-1))]),t("span",te,a(K.value),1)]),t("p",ee,a(o.breakSessions.length)+" break session"+a(o.breakSessions.length!==1?"s":""),1)]),(f(!0),k(ct,null,dt(o.breakSessions,(r,d)=>(f(),k("div",{key:d,class:"flex justify-between items-center p-4 bg-orange-50 rounded-lg border border-orange-200 hover:bg-orange-100 transition-colors duration-150"},[t("div",se,[t("div",ne,[t("span",oe,a(d+1),1)]),t("div",null,[t("p",ae,"Break "+a(d+1),1),t("p",re,a(x(r.start))+" - "+a(r.end?x(r.end):"Ongoing"),1)])]),t("div",ie,[t("p",le,a(J(r)),1)])]))),128))]))]),_:1})]),c(v,{title:"Additional Information"},{default:m(()=>{var r,d;return[t("div",ce,[t("div",de,[t("div",ue,[e[13]||(e[13]=t("span",{class:"text-sm font-medium text-neutral-600"},"Employee",-1)),t("span",me,a(((d=(r=o.attendance.employee)==null?void 0:r.user)==null?void 0:d.name)||"Unknown"),1)]),t("div",fe,[e[14]||(e[14]=t("span",{class:"text-sm font-medium text-neutral-600"},"IP Address",-1)),t("span",ge,a(o.attendance.ip_address||"—"),1)]),t("div",xe,[e[15]||(e[15]=t("span",{class:"text-sm font-medium text-neutral-600"},"Location",-1)),t("span",be,a(o.attendance.location||"—"),1)])]),t("div",ke,[t("div",he,[e[16]||(e[16]=t("span",{class:"text-sm font-medium text-neutral-600"},"Created",-1)),t("span",ye,a(D(o.attendance.created_at)),1)]),t("div",ve,[e[17]||(e[17]=t("span",{class:"text-sm font-medium text-neutral-600"},"Last Updated",-1)),t("span",pe,a(D(o.attendance.updated_at)),1)]),t("div",we,[e[18]||(e[18]=t("span",{class:"text-sm font-medium text-neutral-600"},"Notes",-1)),t("span",_e,a(o.attendance.notes||"—"),1)])])])]}),_:1}),o.attendance.editor?(f(),M(v,{key:0,title:"Edit History"},{default:m(()=>[t("div",De,[t("div",Se,[c(b(E),{class:"w-5 h-5 text-yellow-600"}),t("div",null,[e[19]||(e[19]=t("p",{class:"text-sm font-medium text-yellow-800"},"This record has been edited",-1)),t("p",Ce," Last edited by "+a(o.attendance.editor.name)+" on "+a(D(o.attendance.updated_at)),1)])])])]),_:1})):I("",!0)])]),_:1},8,["subtitle","breadcrumbs","actions"])]}),_:1}))}};export{We as default};
