import{e as S,f as g,g as Q,o as t,h as p,k as y,c as o,i as d,a as e,t as l,l as v,d as R,F as V,r as j,n as Y,u as z,w as L,b as F,S as G,Q as T}from"./app-BcmrdZCd.js";import{A as J}from"./AuthenticatedLayout-Di_P6LQ7.js";import{P as K}from"./PageLayout-BEW72n6f.js";import{c as W}from"./icons-C6-HuDz9.js";import{a as X}from"./UsersIcon-BQCrSt5t.js";import"./useAuth-BW9ORYL6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./PageHeader-DC8hK7wg.js";import"./Icon-Cg6A2F5F.js";const Z={key:0,class:"mb-6 p-4 bg-green-50 border border-green-200 rounded-md"},ee={class:"flex items-center"},se={class:"text-sm text-green-800"},te={key:1,class:"mb-6 p-4 bg-red-50 border border-red-200 rounded-md"},oe={class:"flex items-center"},ne={class:"text-sm text-red-800"},re={key:2,class:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-md"},ae={class:"flex items-start"},le={class:"text-sm text-amber-700 mt-1"},ie={key:3,class:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-md"},de={class:"bg-white rounded-lg shadow-sm border border-gray-200"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ue={class:"px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-sm text-gray-900"},ce={class:"px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-sm text-gray-900"},ge={class:"bg-gray-50 border border-gray-200 rounded-lg p-4"},ve={class:"flex items-center space-x-3 p-3 bg-white border border-gray-200 rounded-md"},fe={class:"flex-shrink-0"},pe={class:"text-lg"},ye={class:"flex-1"},be={class:"text-sm font-medium text-gray-900"},xe={class:"text-xs text-gray-600"},he={class:"flex items-center space-x-4"},ke={class:"flex space-x-1"},we=["onClick"],Ae={key:0,class:"text-lg font-medium text-gray-900"},Ce={key:0,class:"mt-1 text-sm text-red-600"},_e={class:"block text-sm font-medium text-gray-700 mb-2"},Be={key:0,class:"text-red-500"},Me=["required"],Ee={key:0,class:"mt-1 text-sm text-red-600"},Se={key:0,class:"mt-1 text-sm text-red-600"},Ve={key:0,class:"mt-2"},je={class:"text-sm text-gray-600 space-y-1"},ze={class:"flex items-center justify-between pt-6 border-t border-gray-200"},Le={class:"flex items-center space-x-3"},Fe=["disabled"],Te={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},$e={key:1,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ne={key:2},De={key:3},Pe=["disabled"],qe={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Oe={key:1,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ue={key:2},He={key:3},Ie={key:1,class:"text-sm text-gray-600"},ss={__name:"Edit",props:{assessment:Object,employees:Array,competencies:Array,assessmentCycles:Array,assessmentTypes:Array,errors:Object,canEdit:Boolean,isViewingOthersAssessment:Boolean},setup(n){const u=n,r=S({assessment_type:u.assessment.assessment_type,rating:u.assessment.rating||0,comments:u.assessment.comments||"",development_notes:u.assessment.development_notes||"",evidence_files:u.assessment.evidence_files||[]}),i=S(!1),$=g(()=>[{label:"Dashboard",href:route("dashboard")},{label:"Assessments",href:route("competency-assessments.index")},{label:"Assessment Details",href:route("competency-assessments.show",u.assessment.id)},{label:"Edit Assessment",href:null}]),N=g(()=>[{label:"Back to Assessment",href:route("competency-assessments.show",u.assessment.id),icon:W,variant:"secondary"}]),f=g(()=>r.value.rating&&(r.value.rating<=2||r.value.rating>=4)),b=g(()=>r.value.rating&&(!f.value||r.value.comments.trim())),D=()=>{i.value=!0,T.put(route("competency-assessments.update",u.assessment.id),r.value,{onSuccess:()=>{console.log("Assessment updated successfully")},onError:a=>{console.error("Failed to update assessment:",a),i.value=!1},onFinish:()=>{i.value=!1}})},P=()=>{if(!b.value){alert("Please provide a rating and required comments before submitting.");return}confirm("Are you sure you want to submit this assessment? You will not be able to edit it after submission.")&&(i.value=!0,T.post(route("competency-assessments.submit",u.assessment.id),r.value,{onSuccess:()=>{},onError:()=>{i.value=!1},onFinish:()=>{i.value=!1}}))},q=a=>{const s=Array.from(a.target.files);r.value.evidence_files=s.map(c=>c.name)},O=a=>({self:"Self Assessment",manager:"Manager Assessment",peer:"Peer Assessment",360:"360Â° Feedback"})[a]||a,U=a=>({1:"Needs Improvement",2:"Below Expectations",3:"Meets Expectations",4:"Exceeds Expectations",5:"Outstanding"})[a]||"",H=a=>({self:"ðŸ‘¤",manager:"ðŸ‘”",peer:"ðŸ‘¥",360:"ðŸ”„"})[a]||"",I=a=>({self:"Employee self-evaluation",manager:"Manager evaluation of employee",peer:"Peer evaluation",360:"Multi-perspective feedback"})[a]||"";return(a,s)=>(t(),Q(J,null,{default:p(()=>{var c,x,h;return[y(K,{title:"Edit Assessment",subtitle:`${(x=(c=n.assessment.employee)==null?void 0:c.user)==null?void 0:x.name} - ${(h=n.assessment.competency)==null?void 0:h.name}`,breadcrumbs:$.value,actions:N.value},{default:p(()=>{var k,w,A,C,_,B,M,E;return[(k=a.$page.props.flash)!=null&&k.success?(t(),o("div",Z,[e("div",ee,[s[2]||(s[2]=e("svg",{class:"w-5 h-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),e("p",se,l(a.$page.props.flash.success),1)])])):d("",!0),(w=a.$page.props.flash)!=null&&w.error?(t(),o("div",te,[e("div",oe,[s[3]||(s[3]=e("svg",{class:"w-5 h-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),e("p",ne,l(a.$page.props.flash.error),1)])])):d("",!0),n.assessment.assessment_type==="self"&&n.isViewingOthersAssessment?(t(),o("div",re,[e("div",ae,[s[7]||(s[7]=e("svg",{class:"w-5 h-5 text-amber-400 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),e("div",null,[s[6]||(s[6]=e("h4",{class:"text-sm font-medium text-amber-800"},"Self-Assessment Viewing Notice",-1)),e("p",le,[s[4]||(s[4]=v(" You are viewing ")),e("strong",null,l((C=(A=n.assessment.employee)==null?void 0:A.user)==null?void 0:C.name)+"'s",1),s[5]||(s[5]=v(" self-assessment. Self-assessments can only be edited by the employee themselves to maintain assessment integrity. "))])])])])):d("",!0),n.canEdit?d("",!0):(t(),o("div",ie,s[8]||(s[8]=[e("div",{class:"flex items-center"},[e("svg",{class:"w-5 h-5 text-gray-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})]),e("p",{class:"text-sm text-gray-600"},"This assessment is read-only and cannot be edited.")],-1)]))),e("div",de,[e("form",{onSubmit:R(D,["prevent"]),class:"p-6 space-y-6"},[e("div",me,[e("div",null,[s[9]||(s[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Employee",-1)),e("div",ue,l((B=(_=n.assessment.employee)==null?void 0:_.user)==null?void 0:B.name),1)]),e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Competency",-1)),e("div",ce,l((M=n.assessment.competency)==null?void 0:M.name),1)])]),e("div",null,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"Assessment Type",-1)),e("div",ge,[s[11]||(s[11]=e("div",{class:"flex items-center mb-2"},[e("svg",{class:"w-5 h-5 text-gray-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})]),e("span",{class:"text-sm text-gray-600"},"Assessment type cannot be changed after creation")],-1)),e("div",ve,[e("div",fe,[e("span",pe,l(H(n.assessment.assessment_type)),1)]),e("div",ye,[e("h4",be,l(O(n.assessment.assessment_type)),1),e("p",xe,l(I(n.assessment.assessment_type)),1)])])])]),e("div",null,[s[13]||(s[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rating",-1)),e("div",he,[e("div",ke,[(t(),o(V,null,j(5,m=>e("button",{key:m,type:"button",onClick:Qe=>r.value.rating=m,class:Y(["p-1 rounded focus:outline-none focus:ring-2 focus:ring-teal-500",m<=r.value.rating?"text-yellow-400":"text-gray-300 hover:text-yellow-300"])},[y(z(X),{class:"h-8 w-8"})],10,we)),64))]),r.value.rating?(t(),o("span",Ae,l(r.value.rating)+"/5 - "+l(U(r.value.rating)),1)):d("",!0)]),n.errors.rating?(t(),o("div",Ce,l(n.errors.rating),1)):d("",!0)]),e("div",null,[e("label",_e,[s[14]||(s[14]=v(" Comments ")),f.value?(t(),o("span",Be,"*")):d("",!0)]),L(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=m=>r.value.comments=m),required:f.value,rows:"4",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500",placeholder:"Provide detailed feedback and observations..."},null,8,Me),[[F,r.value.comments]]),s[15]||(s[15]=e("p",{class:"mt-1 text-sm text-gray-500"}," Comments are required for ratings of 1-2 (needs improvement) or 4-5 (exceeds expectations). ",-1)),n.errors.comments?(t(),o("div",Ee,l(n.errors.comments),1)):d("",!0)]),e("div",null,[s[16]||(s[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Development Notes",-1)),L(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=m=>r.value.development_notes=m),rows:"3",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500",placeholder:"Suggestions for improvement or development opportunities..."},null,512),[[F,r.value.development_notes]]),n.errors.development_notes?(t(),o("div",Se,l(n.errors.development_notes),1)):d("",!0)]),e("div",null,[s[18]||(s[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Evidence Files",-1)),e("input",{type:"file",multiple:"",onChange:q,class:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100"},null,32),s[19]||(s[19]=e("p",{class:"mt-1 text-sm text-gray-500"}," Upload supporting documents or evidence (optional). ",-1)),(E=r.value.evidence_files)!=null&&E.length?(t(),o("div",Ve,[s[17]||(s[17]=e("div",{class:"text-sm text-gray-700 mb-1"},"Current files:",-1)),e("ul",je,[(t(!0),o(V,null,j(r.value.evidence_files,m=>(t(),o("li",{key:m},l(m),1))),128))])])):d("",!0)]),e("div",ze,[e("div",Le,[e("button",{type:"submit",disabled:i.value,class:"inline-flex items-center px-4 py-2 bg-teal-500 text-white text-sm font-medium rounded-md hover:bg-teal-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 disabled:opacity-50 transition-all duration-200"},[i.value?(t(),o("svg",Te,s[20]||(s[20]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(t(),o("svg",$e,s[21]||(s[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))),i.value?(t(),o("span",Ne,"Saving Changes...")):(t(),o("span",De,"Save Changes"))],8,Fe),n.assessment.status==="draft"&&r.value.rating?(t(),o("button",{key:0,type:"button",onClick:P,disabled:i.value||!b.value,class:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 transition-all duration-200"},[i.value?(t(),o("svg",qe,s[22]||(s[22]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(t(),o("svg",Oe,s[23]||(s[23]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10l2 2m0 0l2-2m-2 2V6m0 6l-2-2"},null,-1)]))),i.value?(t(),o("span",Ue,"Submitting...")):(t(),o("span",He,"Submit Assessment"))],8,Pe)):d("",!0),i.value?(t(),o("div",Ie,l(i.value?"Updating assessment...":""),1)):d("",!0)]),y(z(G),{href:a.route("competency-assessments.show",n.assessment.id),class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-colors duration-200"},{default:p(()=>s[24]||(s[24]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),v(" Cancel ")])),_:1,__:[24]},8,["href"])])],32)])]}),_:1},8,["subtitle","breadcrumbs","actions"])]}),_:1}))}};export{ss as default};
