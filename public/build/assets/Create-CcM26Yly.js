import{x as te,e as w,f as c,g as C,o as n,h as k,k as V,a as o,d as oe,c as r,i as a,w as _,u as d,F as f,r as g,t as i,v as A,b as le,n as S,l as E,Q as v}from"./app-BqTTe0il.js";import{_ as ne}from"./AuthenticatedLayout-CvivcMwS.js";import{P as re}from"./PageLayout-cKuWCVAU.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as N}from"./SecondaryButton-CUSBzo5R.js";import{g as ae,e as T}from"./Icon-DYcCgoR1.js";import"./useAuth-CcobPQ_e.js";import"./ApplicationLogo-CKW47Bcm.js";import"./useAccessibility-iZSY4mI9.js";import"./PageHeader-DEhFexb7.js";/* empty css                                                                   *//* empty css                                                                   */const de={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ce={class:"p-6 text-gray-900"},ue={class:"space-y-4"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe=["value"],ye={key:0,class:"p-3 bg-blue-50 border border-blue-200 rounded-lg"},be={class:"flex items-center justify-between text-sm"},_e={class:"font-medium text-blue-900"},fe={class:"text-blue-700"},ge={class:"space-y-4"},ve={class:"flex items-center justify-between"},xe={key:0,class:"text-sm text-blue-600 font-medium"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},we={class:"relative"},Ce=["value"],ke={key:0,class:"flex items-center justify-between text-sm"},Ae=["disabled"],Se={key:1,class:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg"},Ee=["onClick"],je={class:"flex items-center space-x-3 flex-1"},De={class:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-gray-600 font-medium text-xs flex-shrink-0"},$e={class:"flex-1 min-w-0"},Be={class:"text-sm font-medium text-gray-900 truncate"},Ie={class:"text-xs text-gray-500 truncate"},Ve={key:0},Le={class:"flex-shrink-0"},Ue={class:"space-y-4"},Pe={class:"flex items-center justify-between"},Me={key:0,class:"text-sm text-blue-600 font-medium"},Ne=["value"],Te={key:0,class:"flex items-center justify-between text-sm"},Fe=["disabled"],ze={key:1,class:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg"},Oe=["onClick"],qe={class:"flex-1 min-w-0 pr-3"},He={class:"text-sm font-medium text-gray-900"},Qe={class:"text-xs text-gray-600 mt-1 line-clamp-2"},Re={class:"flex-shrink-0"},Ge={class:"flex items-center justify-between pt-6 border-t border-gray-200"},Je={class:"flex items-center space-x-3"},Ke=["disabled"],We={key:0,class:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Xe={__name:"Create",props:{employees:{type:Array,required:!0},competencies:{type:Array,required:!0},assessmentCycles:{type:Array,default:()=>[]},departments:{type:Array,default:()=>[]}},setup(j){const p=j,s=te({employee_ids:[],competency_ids:[],assessment_type:"manager",assessment_cycle_id:null}),b=w(""),x=w("");w("");const y=w(""),F=c(()=>{let l=p.employees;if(x.value&&(l=l.filter(e=>e.department&&e.department.id===x.value)),b.value&&b.value.length>=2){const e=b.value.toLowerCase();l=l.filter(t=>t.name.toLowerCase().includes(e)||t.position&&t.position.toLowerCase().includes(e))}return l.sort((e,t)=>e.name.localeCompare(t.name))}),u=c(()=>F.value),D=c(()=>p.employees.filter(l=>s.employee_ids.includes(l.id))),z=c(()=>[...new Set(p.competencies.map(e=>e.category))].sort()),m=c(()=>y.value?p.competencies.filter(l=>l.category===y.value).sort((l,e)=>l.name.localeCompare(e.name)):[]),$=c(()=>p.competencies.filter(l=>s.competency_ids.includes(l.id))),h=c(()=>s.assessment_cycle_id?p.assessmentCycles.find(l=>l.id===s.assessment_cycle_id):null),O=c(()=>u.value.length===0?!1:u.value.every(l=>s.employee_ids.includes(l.id))),q=c(()=>m.value.length===0?!1:m.value.every(l=>s.competency_ids.includes(l.id))),L=c(()=>s.employee_ids.length>0&&s.competency_ids.length>0&&!s.processing),B=c(()=>s.employee_ids.length*s.competency_ids.length),H=c(()=>[{label:"Dashboard",href:route("dashboard")},{label:"Assessment Dashboard",href:route("assessment-dashboard")},{label:"Create Assessment",current:!0}]),Q=c(()=>[{label:"Back to Dashboard",href:route("assessment-dashboard"),variant:"secondary",icon:"ArrowLeftIcon"}]),R=l=>l.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2),U=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Not set",G=l=>{s.employee_ids.indexOf(l.id)>-1?s.employee_ids=s.employee_ids.filter(t=>t!==l.id):s.employee_ids=[...s.employee_ids,l.id]},J=l=>{s.competency_ids.indexOf(l.id)>-1?s.competency_ids=s.competency_ids.filter(t=>t!==l.id):s.competency_ids=[...s.competency_ids,l.id]},K=()=>{s.employee_ids=[]},W=()=>{s.competency_ids=[]},X=()=>{const e=u.value.map(t=>t.id).filter(t=>!s.employee_ids.includes(t));s.employee_ids=[...s.employee_ids,...e]},Y=()=>{const e=m.value.map(t=>t.id).filter(t=>!s.competency_ids.includes(t));s.competency_ids=[...s.competency_ids,...e]},P=async()=>{if(s.employee_ids.length===0||s.competency_ids.length===0){alert("Please select at least one employee and one competency");return}if(s.employee_ids.length*s.competency_ids.length===1){const e=new URLSearchParams({employee_id:s.employee_ids[0],competency_id:s.competency_ids[0],assessment_type:s.assessment_type});s.assessment_cycle_id&&e.append("assessment_cycle_id",s.assessment_cycle_id);const t=`${route("assessment-form")}?${e.toString()}`;v.visit(t)}else{s.processing=!0;try{let e=0;for(const t of s.competency_ids)await new Promise((I,se)=>{v.post(route("competency-assessments.bulk-create"),{employee_ids:s.employee_ids,competency_id:t,assessment_type:s.assessment_type,assessment_cycle_id:s.assessment_cycle_id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{e++,I()},onError:M=>{console.error("Bulk create error:",M),se(new Error(Object.values(M).flat().join(", ")))}})});s.processing=!1,v.visit(route("competency-assessments.index"))}catch(e){console.error("Error creating bulk assessments:",e),s.processing=!1,alert(`Failed to create assessments: ${e.message}`)}}},Z=()=>{if(s.employee_ids.length===0||s.competency_ids.length===0){alert("Please select at least one employee and one competency");return}const l=new URLSearchParams({employee_id:s.employee_ids[0],competency_id:s.competency_ids[0],assessment_type:s.assessment_type});s.assessment_cycle_id&&l.append("assessment_cycle_id",s.assessment_cycle_id);const e=`${route("assessment-form")}?${l.toString()}`;v.visit(e)},ee=()=>{v.visit(route("assessment-dashboard"))};return(l,e)=>(n(),C(ne,null,{default:k(()=>[V(re,{title:"Create Assessment",subtitle:"Set up assessment context, select employees and competencies to evaluate",breadcrumbs:H.value,actions:Q.value},{default:k(()=>[e[17]||(e[17]=o("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},[o("div",{class:"flex items-center space-x-2"},[o("div",{class:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium"}," 1 "),o("div",null,[o("p",{class:"text-sm font-medium text-blue-900"},"Setup Assessment"),o("p",{class:"text-xs text-blue-700"},"Configure context, select participants, and create assessments")])])],-1)),o("div",de,[o("div",ce,[o("form",{onSubmit:oe(P,["prevent"]),class:"space-y-8"},[o("div",ue,[e[9]||(e[9]=o("h3",{class:"text-lg font-semibold text-gray-900"},"Assessment Context",-1)),o("div",me,[o("div",null,[e[6]||(e[6]=o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assessment Cycle",-1)),_(o("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>d(s).assessment_cycle_id=t),class:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[5]||(e[5]=o("option",{value:""},"No specific cycle",-1)),(n(!0),r(f,null,g(j.assessmentCycles,t=>(n(),r("option",{key:t.id,value:t.id},i(t.name),9,pe))),128))],512),[[A,d(s).assessment_cycle_id]])]),o("div",null,[e[8]||(e[8]=o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assessment Type",-1)),_(o("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>d(s).assessment_type=t),class:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},e[7]||(e[7]=[o("option",{value:"manager"},"Manager Assessment",-1),o("option",{value:"self"},"Self Assessment",-1),o("option",{value:"peer"},"Peer Assessment",-1),o("option",{value:"360"},"360° Feedback",-1)]),512),[[A,d(s).assessment_type]])])]),h.value?(n(),r("div",ye,[o("div",be,[o("span",_e,i(h.value.name),1),o("span",fe,i(U(h.value.start_date))+" - "+i(U(h.value.end_date)),1)])])):a("",!0)]),o("div",ge,[o("div",ve,[e[10]||(e[10]=o("h3",{class:"text-lg font-semibold text-gray-900"},"Select Employees",-1)),D.value.length>0?(n(),r("div",xe,i(D.value.length)+" selected ",1)):a("",!0)]),o("div",he,[o("div",we,[_(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>b.value=t),type:"text",placeholder:"Search employees...",class:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[le,b.value]]),V(d(ae),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"})]),_(o("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>x.value=t),class:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"},[e[11]||(e[11]=o("option",{value:""},"All Departments",-1)),(n(!0),r(f,null,g(j.departments,t=>(n(),r("option",{key:t.id,value:t.id},i(t.name),9,Ce))),128))],512),[[A,x.value]])]),u.value.length>0?(n(),r("div",ke,[o("button",{type:"button",onClick:X,class:"text-blue-600 hover:text-blue-800 font-medium",disabled:O.value}," Select All ("+i(u.value.length)+") ",9,Ae),D.value.length>0?(n(),r("button",{key:0,type:"button",onClick:K,class:"text-blue-600 hover:text-blue-800 font-medium"}," Clear All ")):a("",!0)])):a("",!0),u.value.length>0?(n(),r("div",Se,[(n(!0),r(f,null,g(u.value,t=>(n(),r("div",{key:t.id,class:S(["flex items-center p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 cursor-pointer transition-colors",{"bg-blue-50 border-blue-200":d(s).employee_ids.includes(t.id)}]),onClick:I=>G(t)},[o("div",je,[o("div",De,i(R(t.name)),1),o("div",$e,[o("p",Be,i(t.name),1),o("p",Ie,[E(i(t.position||"Employee")+" ",1),t.department?(n(),r("span",Ve," • "+i(t.department.name),1)):a("",!0)])])]),o("div",Le,[o("div",{class:S(["w-4 h-4 rounded border-2 flex items-center justify-center",d(s).employee_ids.includes(t.id)?"bg-blue-600 border-blue-600":"border-gray-300"])},[d(s).employee_ids.includes(t.id)?(n(),C(d(T),{key:0,class:"w-3 h-3 text-white"})):a("",!0)],2)])],10,Ee))),128))])):a("",!0)]),o("div",Ue,[o("div",Pe,[e[12]||(e[12]=o("h3",{class:"text-lg font-semibold text-gray-900"},"Select Competencies",-1)),$.value.length>0?(n(),r("div",Me,i($.value.length)+" selected ",1)):a("",!0)]),o("div",null,[_(o("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>y.value=t),class:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"},[e[13]||(e[13]=o("option",{value:""},"Choose a competency category...",-1)),(n(!0),r(f,null,g(z.value,t=>(n(),r("option",{key:t,value:t},i(t),9,Ne))),128))],512),[[A,y.value]])]),y.value&&m.value.length>0?(n(),r("div",Te,[o("button",{type:"button",onClick:Y,class:"text-blue-600 hover:text-blue-800 font-medium",disabled:q.value}," Select All ("+i(m.value.length)+") ",9,Fe),$.value.length>0?(n(),r("button",{key:0,type:"button",onClick:W,class:"text-blue-600 hover:text-blue-800 font-medium"}," Clear All ")):a("",!0)])):a("",!0),y.value&&m.value.length>0?(n(),r("div",ze,[(n(!0),r(f,null,g(m.value,t=>(n(),r("div",{key:t.id,class:S(["flex items-start p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 cursor-pointer transition-colors",{"bg-blue-50 border-blue-200":d(s).competency_ids.includes(t.id)}]),onClick:I=>J(t)},[o("div",qe,[o("p",He,i(t.name),1),o("p",Qe,i(t.description),1)]),o("div",Re,[o("div",{class:S(["w-4 h-4 rounded border-2 flex items-center justify-center",d(s).competency_ids.includes(t.id)?"bg-blue-600 border-blue-600":"border-gray-300"])},[d(s).competency_ids.includes(t.id)?(n(),C(d(T),{key:0,class:"w-3 h-3 text-white"})):a("",!0)],2)])],10,Oe))),128))])):a("",!0)]),o("div",Ge,[o("div",Je,[V(N,{onClick:ee,type:"button"},{default:k(()=>e[14]||(e[14]=[E(" Cancel ")])),_:1,__:[14]}),L.value&&B.value===1?(n(),C(N,{key:0,onClick:Z,type:"button",class:"bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100"},{default:k(()=>e[15]||(e[15]=[o("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),E(" Add Assessment ")])),_:1,__:[15]})):a("",!0)]),o("button",{type:"button",disabled:!L.value,onClick:P,class:"inline-flex items-center px-6 py-3 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[d(s).processing?(n(),r("svg",We,e[16]||(e[16]=[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):a("",!0),E(" "+i(B.value>1?`Create ${B.value} Assessments`:"Create & Complete Assessment"),1)],8,Ke)])],32)])])]),_:1,__:[17]},8,["breadcrumbs","actions"])]),_:1}))}},cs=ie(Xe,[["__scopeId","data-v-758881ee"]]);export{cs as default};
