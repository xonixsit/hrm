import{e as h,f as D,g as L,o as a,h as X,k as m,a as e,c as i,i as f,u,t as o,l as E,F as B,r as N,n as _,w as G,b as J,Q as K}from"./app-BP0mJPoz.js";import{_ as ce}from"./AuthenticatedLayout-CDSONXsj.js";import{P as me}from"./PageLayout-CR_V_dMg.js";import{_ as ue}from"./FileViewerModal-Co4wOOQn.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{e as Q,C as pe,q as ge,l as H,L as xe,M as ye,b as ve,h as be}from"./Icon-BHWzvrQ1.js";import{r as z}from"./DocumentIcon-rCxJ50y2.js";import"./useAuth-nbMsfpWI.js";import"./ApplicationLogo-pPLbGU3W.js";import"./useAccessibility-BaMtWr5G.js";import"./PageHeader-Cm8t4zMh.js";/* empty css                                                                   *//* empty css                                                                   */import"./ArrowTopRightOnSquareIcon-f9PhSwwB.js";import"./ArrowDownTrayIcon-BteoyC1c.js";import"./transition-Cws0njgP.js";const he={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},_e={class:"p-6 text-gray-900"},we={key:0,class:"mb-6"},ke={class:"bg-green-50 border border-green-200 rounded-md p-4"},Ee={class:"flex"},Fe={class:"ml-3"},je={class:"text-sm font-medium text-green-800"},Ce={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Se={class:"lg:col-span-2 space-y-6"},$e={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},Ae={class:"p-6"},De={class:"flex items-center space-x-6"},Be={class:"flex-shrink-0"},Ne={class:"h-16 w-16 rounded-full bg-blue-100 flex items-center justify-center"},ze={class:"text-xl font-bold text-blue-600"},Ue={class:"flex-1"},Me={class:"text-lg font-semibold text-gray-900"},Re={class:"text-gray-600"},Oe={class:"mt-2 flex items-center space-x-4 text-sm text-gray-500"},Te={class:"flex items-center"},Pe={class:"flex items-center"},Ve={class:"mt-6 p-4 bg-gray-50 rounded-lg"},qe={class:"flex items-center justify-between"},Le={class:"font-medium text-gray-900"},Xe={class:"text-sm text-gray-600 mt-1"},Ge={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mt-2"},Je={class:"text-right"},Ke={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},Qe={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},He={class:"p-6"},We={class:"space-y-6"},Ye={class:"grid grid-cols-5 gap-3"},Ze=["onClick"],Ie={class:"flex justify-center mb-2"},es={class:"text-xs font-medium text-gray-700"},ss={class:"text-xs text-gray-500 mt-1"},ts={key:0,class:"mt-2 text-sm text-red-600"},ns={key:0,class:"p-4 bg-purple-50 rounded-lg"},os={class:"flex items-center justify-between"},as={class:"font-medium text-purple-900"},rs={class:"text-sm text-purple-700"},ls={class:"flex"},is={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},ds={class:"p-6 space-y-6"},cs=["readonly"],ms={key:0,class:"mt-1 text-sm text-red-600"},us={class:"mt-2 text-sm text-gray-500"},fs=["readonly"],ps={key:0,class:"mt-1 text-sm text-red-600"},gs={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},xs={class:"p-6"},ys={class:"space-y-4"},vs={key:0,class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-orange-400 transition-colors"},bs=["disabled"],hs={key:1,class:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-gray-300 border-t-orange-600"},_s={key:1,class:"text-center py-8"},ws={key:2,class:"space-y-2"},ks={class:"space-y-2"},Es=["onClick"],Fs={class:"text-sm text-gray-900 hover:text-blue-600"},js={key:0,class:"text-xs text-gray-500 ml-2"},Cs={key:1,class:"text-xs text-gray-500 ml-2"},Ss=["onClick"],$s={class:"space-y-6"},As={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},Ds={class:"p-6"},Bs={class:"space-y-4"},Ns={class:"flex items-center justify-between"},zs={class:"flex items-center justify-between"},Us={class:"text-sm font-medium text-gray-900"},Ms={key:0,class:"flex items-center justify-between"},Rs={class:"text-sm font-medium text-gray-900"},Os={key:0,class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},Ts={class:"p-6 space-y-3"},Ps=["disabled"],Vs=["disabled"],qs={key:0,class:"text-xs text-red-600 mt-2"},Ls={__name:"Evaluate",props:{assessment:Object,errors:Object,canEdit:{type:Boolean,default:!1},isReadOnly:{type:Boolean,default:!0}},setup(n){const d=n,U=()=>{let t=d.assessment.evidence_files||[];if(typeof t=="string")try{t=JSON.parse(t)}catch(s){console.warn("Failed to parse evidence_files JSON:",s),t=[]}return Array.isArray(t)||(t=[]),t},l=h({rating:d.assessment.rating||null,comments:d.assessment.comments||"",development_notes:d.assessment.development_notes||"",evidence_files:U()}),g=h(!1),w=h(!1),x=h(U().map(t=>{if(typeof t=="string")return{name:t,size:null,type:"application/octet-stream",isExisting:!0};if(typeof t=="object"&&t!==null){const s=t.name||t.filename||t.originalName;if(s)return{name:s,size:t.size||null,type:t.type||t.mimeType||"application/octet-stream",isExisting:!0}}return null}).filter(t=>t!==null)),j=h(!1),C=h(""),S=h(""),W=D(()=>{var t,s;return[{label:"Dashboard",href:route("dashboard")},{label:"Competency Management",href:route("competency-assessments.index")},{label:"Assessments",href:route("competency-assessments.index")},{label:`Evaluate ${((s=(t=d.assessment.employee)==null?void 0:t.user)==null?void 0:s.name)||"Assessment"}`,current:!0}]}),Y=D(()=>[{id:"back-to-assessments",label:"Back to Assessments",icon:"arrow-left",variant:"secondary",href:route("competency-assessments.index")}]),$=D(()=>l.value.rating&&l.value.comments&&l.value.comments.trim().length>0),Z=()=>{g.value=!0,K.put(route("competency-assessments.update",d.assessment.id),{employee_id:d.assessment.employee_id,competency_id:d.assessment.competency_id,assessment_type:d.assessment.assessment_type,assessment_cycle_id:d.assessment.assessment_cycle_id,...l.value,status:"draft"},{onSuccess:()=>{},onError:()=>{g.value=!1},onFinish:()=>{g.value=!1}})},I=()=>{if(!$.value){alert("Please provide a rating and comments before submitting.");return}g.value=!0,K.put(route("competency-assessments.update",d.assessment.id),{employee_id:d.assessment.employee_id,competency_id:d.assessment.competency_id,assessment_type:d.assessment.assessment_type,assessment_cycle_id:d.assessment.assessment_cycle_id,...l.value,status:"submitted"},{onSuccess:()=>{},onError:()=>{g.value=!1},onFinish:()=>{g.value=!1}})},ee=async t=>{const s=Array.from(t.target.files);if(s.length===0)return;const y=10*1024*1024,v=s.filter(c=>c.size>y);if(v.length>0){alert(`The following files are too large (max 10MB): ${v.map(c=>c.name).join(", ")}`);return}const k=new FormData;s.forEach(c=>{k.append("files[]",c)}),w.value=!0;try{const c=await fetch(`/assessment-files/${d.assessment.id}/upload`,{method:"POST",body:k,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-Requested-With":"XMLHttpRequest"}});if(c.ok){const p=await c.json(),F=s.map(b=>({name:b.name,size:b.size,type:b.type,isExisting:!1}));x.value.push(...F),l.value.evidence_files=p.all_files||p.files||x.value.map(b=>b.name),t.target.value="",console.log("Files uploaded successfully:",p.files)}else{const p=await c.json().catch(()=>({error:"Unknown error"}));console.error("File upload failed:",p),alert(`File upload failed: ${p.error||c.statusText}`)}}catch(c){console.error("File upload error:",c),alert("File upload failed. Please check your connection and try again.")}finally{w.value=!1}},se=t=>{const s=x.value[t];confirm(`Are you sure you want to remove "${s.name}"?`)&&(x.value.splice(t,1),l.value.evidence_files=x.value.map(y=>y.name))},te=t=>{if(t===0||t===null||t===void 0)return"Unknown size";const s=1024,y=["Bytes","KB","MB","GB"],v=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,v)).toFixed(2))+" "+y[v]},ne=t=>t?t.split(" ").map(s=>s[0]).join("").toUpperCase().slice(0,2):"U",oe=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),M=t=>({self:"Self Assessment",manager:"Manager Assessment",peer:"Peer Assessment",360:"360Â° Feedback"})[t]||t,ae=t=>({draft:"Draft",submitted:"Submitted",approved:"Approved",rejected:"Rejected"})[t]||t,re=t=>({draft:"bg-gray-100 text-gray-800",submitted:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[t]||"bg-gray-100 text-gray-800",R=t=>({1:"Needs Improvement",2:"Below Expectations",3:"Meets Expectations",4:"Exceeds Expectations",5:"Outstanding"})[t]||"",le=t=>{C.value=t,S.value=`/assessment-files/${d.assessment.id}/${t}`,j.value=!0},ie=()=>{j.value=!1,C.value="",S.value=""};return(t,s)=>(a(),L(ce,null,{default:X(()=>[m(me,{title:"Competency Evaluation",subtitle:"Assess employee competency and provide detailed feedback",breadcrumbs:W.value,actions:Y.value},{default:X(()=>{var y,v,k,c,p,F,b,O,T,P,V,q;return[e("div",he,[e("div",_e,[(y=t.$page.props.flash)!=null&&y.success?(a(),i("div",we,[e("div",ke,[e("div",Ee,[m(u(Q),{class:"h-5 w-5 text-green-400"}),e("div",Fe,[e("p",je,o(t.$page.props.flash.success),1)])])])])):f("",!0)]),e("div",Ce,[e("div",Se,[e("div",$e,[s[3]||(s[3]=e("div",{class:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4"},[e("h2",{class:"text-xl font-semibold text-white"},"Assessment Overview")],-1)),e("div",Ae,[e("div",De,[e("div",Be,[e("div",Ne,[e("span",ze,o(ne((k=(v=n.assessment.employee)==null?void 0:v.user)==null?void 0:k.name)),1)])]),e("div",Ue,[e("h3",Me,o((p=(c=n.assessment.employee)==null?void 0:c.user)==null?void 0:p.name),1),e("p",Re,o(((F=n.assessment.employee)==null?void 0:F.position)||"Employee"),1),e("div",Oe,[e("span",Te,[m(u(pe),{class:"w-4 h-4 mr-1"}),E(" "+o(((O=(b=n.assessment.employee)==null?void 0:b.department)==null?void 0:O.name)||"No Department"),1)]),e("span",Pe,[m(u(ge),{class:"w-4 h-4 mr-1"}),E(" "+o(oe(n.assessment.created_at)),1)])])])]),e("div",Ve,[e("div",qe,[e("div",null,[e("h4",Le,o((T=n.assessment.competency)==null?void 0:T.name),1),e("p",Xe,o((P=n.assessment.competency)==null?void 0:P.description),1),e("span",Ge,o((V=n.assessment.competency)==null?void 0:V.category),1)]),e("div",Je,[e("span",Ke,o(M(n.assessment.assessment_type)),1)])])])])]),e("div",Qe,[s[5]||(s[5]=e("div",{class:"bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4"},[e("h2",{class:"text-xl font-semibold text-white"},"Performance Rating")],-1)),e("div",He,[e("div",We,[e("div",null,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-4"},"Overall Competency Rating *",-1)),e("div",Ye,[(a(),i(B,null,N(5,r=>e("div",{key:r,onClick:A=>n.canEdit?l.value.rating=r:null,class:_([n.canEdit?"cursor-pointer group":"cursor-not-allowed opacity-60"])},[e("div",{class:_(["p-4 rounded-lg border-2 text-center transition-all duration-200",l.value.rating>=r?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300 hover:bg-purple-25"])},[e("div",Ie,[m(u(H),{class:_(["w-6 h-6",l.value.rating>=r?"text-purple-500 fill-current":"text-gray-400"])},null,8,["class"])]),e("div",es,o(r),1),e("div",ss,o(R(r)),1)],2)],10,Ze)),64))]),n.errors.rating?(a(),i("div",ts,o(n.errors.rating),1)):f("",!0)]),l.value.rating?(a(),i("div",ns,[e("div",os,[e("div",null,[e("h4",as,"Selected Rating: "+o(l.value.rating)+"/5",1),e("p",rs,o(R(l.value.rating)),1)]),e("div",ls,[(a(),i(B,null,N(5,r=>m(u(H),{key:r,class:_(["w-5 h-5",r<=l.value.rating?"text-purple-500 fill-current":"text-gray-300"])},null,8,["class"])),64))])])])):f("",!0)])])]),e("div",is,[s[8]||(s[8]=e("div",{class:"bg-gradient-to-r from-green-600 to-green-700 px-6 py-4"},[e("h2",{class:"text-xl font-semibold text-white"},"Detailed Feedback")],-1)),e("div",ds,[e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Assessment Comments *",-1)),G(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=r=>l.value.comments=r),readonly:!n.canEdit,rows:"6",placeholder:"Provide detailed feedback on the employee's performance in this competency. Include specific examples, strengths, and areas for improvement...",class:_(["w-full rounded-md border-gray-300 shadow-sm",n.canEdit?"focus:border-green-500 focus:ring-green-500":"bg-gray-50 cursor-not-allowed"])},null,10,cs),[[J,l.value.comments]]),n.errors.comments?(a(),i("div",ms,o(n.errors.comments),1)):f("",!0),e("p",us,o(((q=l.value.comments)==null?void 0:q.length)||0)+" characters",1)]),e("div",null,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Development Recommendations",-1)),G(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=r=>l.value.development_notes=r),readonly:!n.canEdit,rows:"4",placeholder:"Suggest specific actions, training, or resources to help the employee improve in this competency...",class:_(["w-full rounded-md border-gray-300 shadow-sm",n.canEdit?"focus:border-green-500 focus:ring-green-500":"bg-gray-50 cursor-not-allowed"])},null,10,fs),[[J,l.value.development_notes]]),n.errors.development_notes?(a(),i("div",ps,o(n.errors.development_notes),1)):f("",!0)])])]),e("div",gs,[s[13]||(s[13]=e("div",{class:"bg-gradient-to-r from-orange-600 to-orange-700 px-6 py-4"},[e("h2",{class:"text-xl font-semibold text-white"},"Supporting Evidence")],-1)),e("div",xs,[e("div",ys,[s[12]||(s[12]=e("p",{class:"text-sm text-gray-600"},"Upload documents, screenshots, or other evidence that supports your assessment.",-1)),n.canEdit?(a(),i("div",vs,[m(u(xe),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s[9]||(s[9]=e("p",{class:"text-sm text-gray-600 mb-2"},"Drag and drop files here, or click to browse",-1)),e("input",{type:"file",multiple:"",class:"hidden",ref:"fileInput",onChange:ee},null,544),e("button",{type:"button",onClick:s[2]||(s[2]=r=>t.$refs.fileInput.click()),disabled:w.value,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed"},[w.value?(a(),i("div",hs)):(a(),L(u(ye),{key:0,class:"w-4 h-4 mr-2"})),E(" "+o(w.value?"Uploading...":"Choose Files"),1)],8,bs)])):x.value.length===0?(a(),i("div",_s,[m(u(z),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s[10]||(s[10]=e("p",{class:"text-sm text-gray-500"},"No supporting evidence uploaded",-1))])):f("",!0),x.value.length>0?(a(),i("div",ws,[s[11]||(s[11]=e("h4",{class:"text-sm font-medium text-gray-700"},"Uploaded Files:",-1)),e("div",ks,[(a(!0),i(B,null,N(x.value,(r,A)=>(a(),i("div",{key:A,class:"flex items-center justify-between p-3 bg-gray-50 rounded-md"},[e("div",{class:"flex items-center cursor-pointer",onClick:de=>le(r.name)},[m(u(z),{class:"w-5 h-5 text-gray-400 mr-3"}),e("span",Fs,o(r.name),1),r.size!==null?(a(),i("span",js,"("+o(te(r.size))+")",1)):r.isExisting?(a(),i("span",Cs,"(Existing file)")):f("",!0),m(u(ve),{class:"w-4 h-4 text-gray-400 ml-2"})],8,Es),n.canEdit?(a(),i("button",{key:0,type:"button",onClick:de=>se(A),class:"text-red-500 hover:text-red-700"},[m(u(be),{class:"w-4 h-4"})],8,Ss)):f("",!0)]))),128))])])):f("",!0)])])])]),e("div",$s,[e("div",As,[s[17]||(s[17]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Assessment Status")],-1)),e("div",Ds,[e("div",Bs,[e("div",Ns,[s[14]||(s[14]=e("span",{class:"text-sm text-gray-600"},"Current Status:",-1)),e("span",{class:_([re(n.assessment.status),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"])},o(ae(n.assessment.status)),3)]),e("div",zs,[s[15]||(s[15]=e("span",{class:"text-sm text-gray-600"},"Assessment Type:",-1)),e("span",Us,o(M(n.assessment.assessment_type)),1)]),n.assessment.assessment_cycle?(a(),i("div",Ms,[s[16]||(s[16]=e("span",{class:"text-sm text-gray-600"},"Cycle:",-1)),e("span",Rs,o(n.assessment.assessment_cycle.name),1)])):f("",!0)])])]),n.canEdit?(a(),i("div",Os,[s[20]||(s[20]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Actions")],-1)),e("div",Ts,[e("button",{onClick:Z,disabled:g.value,class:"w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[m(u(z),{class:"w-4 h-4 mr-2"}),s[18]||(s[18]=E(" Save as Draft "))],8,Ps),e("button",{onClick:I,disabled:g.value||!$.value,class:"w-full inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[m(u(Q),{class:"w-4 h-4 mr-2"}),s[19]||(s[19]=E(" Submit Assessment "))],8,Vs),$.value?f("",!0):(a(),i("div",qs," Please provide a rating and comments before submitting. "))])])):f("",!0),s[21]||(s[21]=e("div",{class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},[e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Rating Guidelines")]),e("div",{class:"p-6"},[e("div",{class:"space-y-3 text-sm"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-6 h-6 rounded-full bg-red-100 flex items-center justify-center mr-3"},[e("span",{class:"text-xs font-bold text-red-600"},"1")]),e("div",null,[e("div",{class:"font-medium text-gray-900"},"Needs Improvement"),e("div",{class:"text-gray-600"},"Below expectations, requires significant development")])]),e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-6 h-6 rounded-full bg-orange-100 flex items-center justify-center mr-3"},[e("span",{class:"text-xs font-bold text-orange-600"},"2")]),e("div",null,[e("div",{class:"font-medium text-gray-900"},"Below Expectations"),e("div",{class:"text-gray-600"},"Some skills present but needs improvement")])]),e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-6 h-6 rounded-full bg-yellow-100 flex items-center justify-center mr-3"},[e("span",{class:"text-xs font-bold text-yellow-600"},"3")]),e("div",null,[e("div",{class:"font-medium text-gray-900"},"Meets Expectations"),e("div",{class:"text-gray-600"},"Competent performance, meets job requirements")])]),e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center mr-3"},[e("span",{class:"text-xs font-bold text-blue-600"},"4")]),e("div",null,[e("div",{class:"font-medium text-gray-900"},"Exceeds Expectations"),e("div",{class:"text-gray-600"},"Strong performance, above average skills")])]),e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-6 h-6 rounded-full bg-green-100 flex items-center justify-center mr-3"},[e("span",{class:"text-xs font-bold text-green-600"},"5")]),e("div",null,[e("div",{class:"font-medium text-gray-900"},"Outstanding"),e("div",{class:"text-gray-600"},"Exceptional performance, role model for others")])])])])],-1))])])]),m(ue,{show:j.value,fileName:C.value,fileUrl:S.value,onClose:ie},null,8,["show","fileName","fileUrl"])]}),_:1},8,["breadcrumbs","actions"])]),_:1}))}},rt=fe(Ls,[["__scopeId","data-v-e4dda6e9"]]);export{rt as default};
