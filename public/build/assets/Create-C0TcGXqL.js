import{x as N,e as v,f as c,g as x,o as n,h,k as $,a as e,d as ee,c as r,i as d,w as y,u as a,F as b,r as _,t as i,v as w,b as se,n as k,l as C,Q as A}from"./app-BuZ8QPkp.js";import{_ as te}from"./AuthenticatedLayout-Dhycl0eR.js";import{P as oe}from"./PageLayout-ChNA6PkZ.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as T}from"./SecondaryButton-D6SlH19r.js";import{g as ne,e as F}from"./Icon-iw-cBB3h.js";import"./useAuth-oa3hJQF1.js";import"./ApplicationLogo-BZWhHHH8.js";import"./useAccessibility-BMZysmHz.js";import"./PageHeader-CU56p9rF.js";/* empty css                                                                   *//* empty css                                                                   */const re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ie={class:"p-6 text-gray-900"},ae={class:"space-y-4"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ce=["value"],ue={key:0,class:"p-3 bg-blue-50 border border-blue-200 rounded-lg"},me={class:"flex items-center justify-between text-sm"},pe={class:"font-medium text-blue-900"},ye={class:"text-blue-700"},be={class:"space-y-4"},_e={class:"flex items-center justify-between"},fe={key:0,class:"text-sm text-blue-600 font-medium"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={class:"relative"},xe=["value"],he={key:0,class:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg"},we=["onClick"],ke={class:"flex items-center space-x-3 flex-1"},Ce={class:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-gray-600 font-medium text-xs flex-shrink-0"},Ae={class:"flex-1 min-w-0"},Se={class:"text-sm font-medium text-gray-900 truncate"},je={class:"text-xs text-gray-500 truncate"},De={key:0},Ee={class:"flex-shrink-0"},Ve={key:1,class:"flex justify-end"},$e={class:"space-y-4"},Be={class:"flex items-center justify-between"},Le={key:0,class:"text-sm text-blue-600 font-medium"},Pe=["value"],Ue={key:0,class:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg"},Me=["onClick"],Ne={class:"flex-1 min-w-0 pr-3"},Te={class:"text-sm font-medium text-gray-900"},Fe={class:"text-xs text-gray-600 mt-1 line-clamp-2"},ze={class:"flex-shrink-0"},Ie={key:1,class:"flex justify-end"},qe={class:"flex items-center justify-between pt-6 border-t border-gray-200"},He={class:"flex items-center space-x-3"},Oe=["disabled"],Qe={key:0,class:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Re={__name:"Create",props:{employees:{type:Array,required:!0},competencies:{type:Array,required:!0},assessmentCycles:{type:Array,default:()=>[]},departments:{type:Array,default:()=>[]}},setup(S){const u=S,o=N({employee_ids:[],competency_ids:[],assessment_type:"manager",assessment_cycle_id:null}),m=v(""),f=v("");v("");const p=v(""),z=c(()=>{let l=u.employees;if(f.value&&(l=l.filter(s=>s.department&&s.department.id===f.value)),m.value&&m.value.length>=2){const s=m.value.toLowerCase();l=l.filter(t=>t.name.toLowerCase().includes(s)||t.position&&t.position.toLowerCase().includes(s))}return l.sort((s,t)=>s.name.localeCompare(t.name))}),B=c(()=>z.value),j=c(()=>u.employees.filter(l=>o.employee_ids.includes(l.id))),I=c(()=>[...new Set(u.competencies.map(s=>s.category))].sort()),L=c(()=>p.value?u.competencies.filter(l=>l.category===p.value).sort((l,s)=>l.name.localeCompare(s.name)):[]),D=c(()=>u.competencies.filter(l=>o.competency_ids.includes(l.id))),g=c(()=>o.assessment_cycle_id?u.assessmentCycles.find(l=>l.id===o.assessment_cycle_id):null),P=c(()=>o.employee_ids.length>0&&o.competency_ids.length>0&&!o.processing),E=c(()=>o.employee_ids.length*o.competency_ids.length),q=c(()=>[{label:"Dashboard",href:route("dashboard")},{label:"Assessment Dashboard",href:route("assessment-dashboard")},{label:"Create Assessment",current:!0}]),H=c(()=>[{label:"Back to Dashboard",href:route("assessment-dashboard"),variant:"secondary",icon:"ArrowLeftIcon"}]),O=l=>l.split(" ").map(s=>s.charAt(0)).join("").toUpperCase().slice(0,2),U=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Not set",Q=l=>{o.employee_ids.indexOf(l.id)>-1?o.employee_ids=o.employee_ids.filter(t=>t!==l.id):o.employee_ids=[...o.employee_ids,l.id]},R=l=>{o.competency_ids.indexOf(l.id)>-1?o.competency_ids=o.competency_ids.filter(t=>t!==l.id):o.competency_ids=[...o.competency_ids,l.id]},G=()=>{o.employee_ids=[]},J=()=>{o.competency_ids=[]},M=()=>{if(o.employee_ids.length===0||o.competency_ids.length===0){alert("Please select at least one employee and one competency");return}if(o.employee_ids.length*o.competency_ids.length===1){const s=new URLSearchParams({employee_id:o.employee_ids[0],competency_id:o.competency_ids[0],assessment_type:o.assessment_type});o.assessment_cycle_id&&s.append("assessment_cycle_id",o.assessment_cycle_id);const t=`${route("assessment-form")}?${s.toString()}`;A.visit(t)}else{const s=o.competency_ids.map(t=>{const V=N({employee_ids:o.employee_ids,competency_id:t,assessment_type:o.assessment_type,assessment_cycle_id:o.assessment_cycle_id});return new Promise((X,Y)=>{V.post(route("competency-assessments.bulk-create"),{onSuccess:()=>X(),onError:Z=>Y(Z)})})});o.processing=!0,Promise.all(s).then(()=>{A.visit(route("competency-assessments.index"))}).catch(t=>{console.error("Error creating bulk assessments:",t),o.processing=!1})}},K=()=>{if(o.employee_ids.length===0||o.competency_ids.length===0){alert("Please select at least one employee and one competency");return}const l=new URLSearchParams({employee_id:o.employee_ids[0],competency_id:o.competency_ids[0],assessment_type:o.assessment_type});o.assessment_cycle_id&&l.append("assessment_cycle_id",o.assessment_cycle_id);const s=`${route("assessment-form")}?${l.toString()}`;A.visit(s)},W=()=>{A.visit(route("assessment-dashboard"))};return(l,s)=>(n(),x(te,null,{default:h(()=>[$(oe,{title:"Create Assessment",subtitle:"Set up assessment context, select employees and competencies to evaluate",breadcrumbs:q.value,actions:H.value},{default:h(()=>[s[17]||(s[17]=e("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},[e("div",{class:"flex items-center space-x-2"},[e("div",{class:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-medium"}," 1 "),e("div",null,[e("p",{class:"text-sm font-medium text-blue-900"},"Setup Assessment"),e("p",{class:"text-xs text-blue-700"},"Configure context, select participants, and create assessments")])])],-1)),e("div",re,[e("div",ie,[e("form",{onSubmit:ee(M,["prevent"]),class:"space-y-8"},[e("div",ae,[s[9]||(s[9]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Assessment Context",-1)),e("div",de,[e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assessment Cycle",-1)),y(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>a(o).assessment_cycle_id=t),class:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[s[5]||(s[5]=e("option",{value:""},"No specific cycle",-1)),(n(!0),r(b,null,_(S.assessmentCycles,t=>(n(),r("option",{key:t.id,value:t.id},i(t.name),9,ce))),128))],512),[[w,a(o).assessment_cycle_id]])]),e("div",null,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assessment Type",-1)),y(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>a(o).assessment_type=t),class:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},s[7]||(s[7]=[e("option",{value:"manager"},"Manager Assessment",-1),e("option",{value:"self"},"Self Assessment",-1),e("option",{value:"peer"},"Peer Assessment",-1),e("option",{value:"360"},"360° Feedback",-1)]),512),[[w,a(o).assessment_type]])])]),g.value?(n(),r("div",ue,[e("div",me,[e("span",pe,i(g.value.name),1),e("span",ye,i(U(g.value.start_date))+" - "+i(U(g.value.end_date)),1)])])):d("",!0)]),e("div",be,[e("div",_e,[s[10]||(s[10]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Select Employees",-1)),j.value.length>0?(n(),r("div",fe,i(j.value.length)+" selected ",1)):d("",!0)]),e("div",ge,[e("div",ve,[y(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>m.value=t),type:"text",placeholder:"Search employees...",class:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[se,m.value]]),$(a(ne),{class:"absolute left-3 top-3 h-4 w-4 text-gray-400"})]),y(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>f.value=t),class:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"},[s[11]||(s[11]=e("option",{value:""},"All Departments",-1)),(n(!0),r(b,null,_(S.departments,t=>(n(),r("option",{key:t.id,value:t.id},i(t.name),9,xe))),128))],512),[[w,f.value]])]),B.value.length>0?(n(),r("div",he,[(n(!0),r(b,null,_(B.value,t=>(n(),r("div",{key:t.id,class:k(["flex items-center p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 cursor-pointer transition-colors",{"bg-blue-50 border-blue-200":a(o).employee_ids.includes(t.id)}]),onClick:V=>Q(t)},[e("div",ke,[e("div",Ce,i(O(t.name)),1),e("div",Ae,[e("p",Se,i(t.name),1),e("p",je,[C(i(t.position||"Employee")+" ",1),t.department?(n(),r("span",De," • "+i(t.department.name),1)):d("",!0)])])]),e("div",Ee,[e("div",{class:k(["w-4 h-4 rounded border-2 flex items-center justify-center",a(o).employee_ids.includes(t.id)?"bg-blue-600 border-blue-600":"border-gray-300"])},[a(o).employee_ids.includes(t.id)?(n(),x(a(F),{key:0,class:"w-3 h-3 text-white"})):d("",!0)],2)])],10,we))),128))])):d("",!0),j.value.length>0?(n(),r("div",Ve,[e("button",{type:"button",onClick:G,class:"text-sm text-blue-600 hover:text-blue-800 font-medium"}," Clear All ")])):d("",!0)]),e("div",$e,[e("div",Be,[s[12]||(s[12]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Select Competencies",-1)),D.value.length>0?(n(),r("div",Le,i(D.value.length)+" selected ",1)):d("",!0)]),e("div",null,[y(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>p.value=t),class:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"},[s[13]||(s[13]=e("option",{value:""},"Choose a competency category...",-1)),(n(!0),r(b,null,_(I.value,t=>(n(),r("option",{key:t,value:t},i(t),9,Pe))),128))],512),[[w,p.value]])]),p.value&&L.value.length>0?(n(),r("div",Ue,[(n(!0),r(b,null,_(L.value,t=>(n(),r("div",{key:t.id,class:k(["flex items-start p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 cursor-pointer transition-colors",{"bg-blue-50 border-blue-200":a(o).competency_ids.includes(t.id)}]),onClick:V=>R(t)},[e("div",Ne,[e("p",Te,i(t.name),1),e("p",Fe,i(t.description),1)]),e("div",ze,[e("div",{class:k(["w-4 h-4 rounded border-2 flex items-center justify-center",a(o).competency_ids.includes(t.id)?"bg-blue-600 border-blue-600":"border-gray-300"])},[a(o).competency_ids.includes(t.id)?(n(),x(a(F),{key:0,class:"w-3 h-3 text-white"})):d("",!0)],2)])],10,Me))),128))])):d("",!0),D.value.length>0?(n(),r("div",Ie,[e("button",{type:"button",onClick:J,class:"text-sm text-blue-600 hover:text-blue-800 font-medium"}," Clear All ")])):d("",!0)]),e("div",qe,[e("div",He,[$(T,{onClick:W,type:"button"},{default:h(()=>s[14]||(s[14]=[C(" Cancel ")])),_:1,__:[14]}),P.value&&E.value===1?(n(),x(T,{key:0,onClick:K,type:"button",class:"bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100"},{default:h(()=>s[15]||(s[15]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),C(" Add Assessment ")])),_:1,__:[15]})):d("",!0)]),e("button",{type:"button",disabled:!P.value,onClick:M,class:"inline-flex items-center px-6 py-3 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[a(o).processing?(n(),r("svg",Qe,s[16]||(s[16]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):d("",!0),C(" "+i(E.value>1?`Create ${E.value} Assessments`:"Create & Complete Assessment"),1)],8,Oe)])],32)])])]),_:1,__:[17]},8,["breadcrumbs","actions"])]),_:1}))}},ns=le(Re,[["__scopeId","data-v-f3fbfc86"]]);export{ns as default};
