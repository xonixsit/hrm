import{e as _,f as v,z as G,B as J,c as h,i as P,o as m,a as s,t as M,y as re,n as I,u as y,F as j,r as H,w as te,l as X,p as oe,Q as fe,g as q,s as K,A as ae,q as ce,C as ve,M as se,k as Q,h as he,N as ue,O as pe,d as ge,P as ye,K as ie,R as ke}from"./app-Buc0nobf.js";import{u as ee}from"./useAuth-BF2GuhYq.js";import{D as ne,E as we,t as be}from"./icons-BBDwb46A.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as xe}from"./useAccessibility-Ue6MbINv.js";const _e={key:0,class:"fixed top-4 right-4 z-50 max-w-md"},Ae={class:"bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg"},Te={class:"flex items-start"},Ie={class:"ml-3 flex-1"},Be={class:"mt-1 text-sm text-red-700"},Se={key:0,class:"mt-3"},Ce={__name:"NavigationErrorDisplay",setup(c){const t=_(!1),e=_(""),o=_(null),a=_(null),r=v(()=>e.value.includes("log in")?"Go to Login":e.value.includes("permission")?"Go to Dashboard":e.value.includes("network")?"Reload Page":"Try Again"),i=(B,A=null)=>{e.value=B,o.value=A,t.value=!0,a.value&&clearTimeout(a.value),a.value=setTimeout(()=>{p()},1e4)},k=async()=>{if(o.value)try{await o.value()}catch(B){console.error("[NAVIGATION ERROR DISPLAY] Fallback action failed:",B)}p()},p=()=>{t.value=!1,e.value="",o.value=null,a.value&&(clearTimeout(a.value),a.value=null)};return G(()=>{typeof window<"u"&&(window.showNavigationError=i)}),J(()=>{typeof window<"u"&&delete window.showNavigationError,a.value&&clearTimeout(a.value)}),(B,A)=>t.value?(m(),h("div",_e,[s("div",Ae,[s("div",Te,[A[2]||(A[2]=s("div",{class:"flex-shrink-0"},[s("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),s("div",Ie,[A[0]||(A[0]=s("h3",{class:"text-sm font-medium text-red-800"}," Navigation Error ",-1)),s("div",Be,M(e.value),1),o.value?(m(),h("div",Se,[s("button",{onClick:k,class:"bg-red-100 hover:bg-red-200 text-red-800 text-xs font-medium px-3 py-1 rounded-md transition-colors duration-200"},M(r.value),1)])):P("",!0)]),s("div",{class:"ml-4 flex-shrink-0"},[s("button",{onClick:p,class:"bg-red-50 rounded-md inline-flex text-red-400 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},A[1]||(A[1]=[s("span",{class:"sr-only"},"Close",-1),s("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])])):P("",!0)}},U=_("light"),W=_("light"),V=_(!1),Z={light:{name:"Light",key:"light",colors:{background:"#fafafa",surface:"#ffffff",text:"#111827",textSecondary:"#6b7280",border:"#e5e5e5"}},dark:{name:"Dark",key:"dark",colors:{background:"#0a0a0a",surface:"#111827",text:"#fafafa",textSecondary:"#d4d4d4",border:"#404040"}}};function de(){const c=v(()=>V.value?W.value:U.value),t=v(()=>Z[c.value]),e=v(()=>c.value==="dark"),o=v(()=>c.value==="light"),a=()=>{if(typeof window>"u")return"light";try{return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch(n){return console.warn("Failed to detect system theme:",n),"light"}},r=(n,l=!1)=>{try{const D={theme:g(n)?n:"light",useSystem:!!l,timestamp:new Date().toISOString(),version:1};localStorage.setItem("theme-preference",JSON.stringify(D))}catch($){console.warn("Failed to save theme preference:",$);try{localStorage.removeItem("theme-preference")}catch(D){console.warn("Failed to clear corrupted theme preference:",D)}}},i=n=>{if(!(typeof document>"u"))try{const l=document.documentElement,$=g(n)?n:"light";l.classList.remove("theme-light","theme-dark"),l.classList.add(`theme-${$}`),k($);try{window.dispatchEvent(new CustomEvent("theme-changed",{detail:{theme:$,config:Z[$]}}))}catch(D){console.warn("Failed to dispatch theme change event:",D)}}catch(l){console.error("Failed to apply theme:",l);try{const $=document.documentElement;$.classList.remove("theme-light","theme-dark"),$.classList.add("theme-light"),k("light")}catch($){console.error("Failed to apply fallback theme:",$)}}},k=n=>{if(!(typeof document>"u"))try{const l=document.documentElement;n==="dark"?(l.style.setProperty("--color-neutral-50","#0a0a0a"),l.style.setProperty("--color-neutral-100","#111827"),l.style.setProperty("--color-neutral-200","#262626"),l.style.setProperty("--color-neutral-300","#404040"),l.style.setProperty("--color-neutral-400","#525252"),l.style.setProperty("--color-neutral-500","#6b7280"),l.style.setProperty("--color-neutral-600","#a3a3a3"),l.style.setProperty("--color-neutral-700","#d4d4d4"),l.style.setProperty("--color-neutral-800","#e5e5e5"),l.style.setProperty("--color-neutral-900","#fafafa"),l.style.setProperty("--color-neutral-950","#ffffff")):(l.style.setProperty("--color-neutral-50","#fafafa"),l.style.setProperty("--color-neutral-100","#f5f5f5"),l.style.setProperty("--color-neutral-200","#e5e5e5"),l.style.setProperty("--color-neutral-300","#d4d4d4"),l.style.setProperty("--color-neutral-400","#a3a3a3"),l.style.setProperty("--color-neutral-500","#6b7280"),l.style.setProperty("--color-neutral-600","#525252"),l.style.setProperty("--color-neutral-700","#404040"),l.style.setProperty("--color-neutral-800","#262626"),l.style.setProperty("--color-neutral-900","#111827"),l.style.setProperty("--color-neutral-950","#0a0a0a"))}catch(l){console.warn("Failed to update theme properties:",l)}},p=n=>{i(n)},B=n=>{if(!Z[n]){console.warn(`Theme "${n}" not found`);return}U.value=n,V.value=!1,r(n,!1),p(n)},A=()=>{V.value=!0;const n=a();W.value=n,r(n,!0),p(n)},u=()=>{const n=c.value==="light"?"dark":"light";B(n)},g=n=>Z.hasOwnProperty(n),w=()=>Object.values(Z),N=()=>{},z=()=>{const n=[];if(g(U.value)||n.push(`Invalid current theme: ${U.value}`),g(W.value)||n.push(`Invalid system theme: ${W.value}`),g(c.value)||n.push(`Invalid active theme: ${c.value}`),typeof document<"u"){const l=document.documentElement,$=l.classList.contains("theme-light"),D=l.classList.contains("theme-dark");!$&&!D&&n.push("No theme class found on document root"),$&&D&&n.push("Multiple theme classes found on document root");const R=`theme-${c.value}`;l.classList.contains(R)||n.push(`Expected theme class ${R} not found on document root`)}return{isValid:n.length===0,issues:n}},C=()=>{if(!(typeof document>"u"))try{const n=document.documentElement;return["theme-light","theme-dark"].forEach($=>{n.classList.remove($)}),!0}catch(n){return console.warn("Failed to cleanup theme classes:",n),!1}},f=()=>{try{U.value="light",W.value=a(),V.value=!1;try{localStorage.removeItem("theme-preference")}catch(n){console.warn("Failed to clear theme preference from localStorage:",n)}return i("light"),!0}catch(n){return console.error("Failed to reset theme to default:",n),!1}},O=()=>{console.warn("Attempting theme system recovery...");try{if(C(),f())return console.log("Theme system recovery successful"),!0;throw new Error("Failed to reset theme to default")}catch(n){console.error("Theme system recovery failed:",n);try{return typeof document<"u"&&document.documentElement.classList.add("theme-light"),!1}catch(l){return console.error("Last resort theme recovery failed:",l),!1}}},b=()=>{try{U.value="light",W.value="light",V.value=!1;try{localStorage.removeItem("theme-preference")}catch(n){console.warn("Failed to clear theme preference:",n)}if(typeof document<"u"){const n=document.documentElement;n.classList.remove("theme-light","theme-dark","dark","light"),n.classList.add("theme-light"),n.style.setProperty("--color-neutral-50","#fafafa"),n.style.setProperty("--color-neutral-100","#f5f5f5"),n.style.setProperty("--color-neutral-200","#e5e5e5"),n.style.setProperty("--color-neutral-300","#d4d4d4"),n.style.setProperty("--color-neutral-400","#a3a3a3"),n.style.setProperty("--color-neutral-500","#6b7280"),n.style.setProperty("--color-neutral-600","#525252"),n.style.setProperty("--color-neutral-700","#404040"),n.style.setProperty("--color-neutral-800","#262626"),n.style.setProperty("--color-neutral-900","#111827"),n.style.setProperty("--color-neutral-950","#0a0a0a")}return null}catch(n){console.error("Theme initialization failed:",n);try{typeof document<"u"&&(document.documentElement.classList.add("theme-light"),document.documentElement.classList.remove("theme-dark","dark"))}catch(l){console.error("Emergency theme fallback failed:",l)}return null}};return G(()=>{b()}),re(c,n=>{p(n)}),{currentTheme:v(()=>U.value),systemTheme:v(()=>W.value),activeTheme:c,themeConfig:t,isDark:e,isLight:o,isSystemThemePreferred:v(()=>V.value),setTheme:B,toggleTheme:u,useSystemTheme:A,validateTheme:g,getAvailableThemes:w,debugThemeState:N,initializeTheme:b,validateThemeState:z,cleanupThemeClasses:C,resetThemeToDefault:f,recoverThemeSystem:O,cleanupAndApplyTheme:i,themes:v(()=>Z)}}const $e={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Ee={class:"flex justify-between h-16"},Me={class:"flex items-center space-x-8"},Ne={class:"flex-shrink-0"},Le={class:"hidden md:flex space-x-1"},Pe=["href"],De={class:"py-1"},Fe=["href"],Oe={class:"flex items-center space-x-4"},Re={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ze={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qe={class:"hidden md:block"},Ge={class:"py-1"},Ue=["href"],We={class:"md:hidden px-4 pb-3"},je={class:"mt-2 space-y-1"},He=["href"],Ve={__name:"QuickTopNav",props:{currentRoute:{type:String,required:!0}},setup(c){const t=c,{user:e,roles:o}=ee(),{isDark:a,toggleTheme:r}=de();console.log("QuickTopNav - User:",e.value),console.log("QuickTopNav - Roles:",o.value);const i=_(!1),k=_(!1),p=_(!1),B=v(()=>{var C;return(C=e.value)!=null&&C.name?e.value.name.split(" ").map(f=>f[0]).join("").toUpperCase():"U"});v(()=>Array.isArray(o.value)?o.value:[]);const A=v(()=>[{route:"dashboard",label:"Dashboard"},{route:"profile.edit",label:"My Profile"},{route:"attendances.index",label:"Time Tracking"},{route:"leaves.index",label:"Leave Requests"},{route:"competency-assessments.my-assessments",label:"My Assessments"}]),u=v(()=>{const C=o.value,f=[{route:"work-reports.index",label:"Work Reports"},{route:"work-reports.leaderboard",label:"Leaderboard"},{route:"feedbacks.index",label:"Feedback"}];return(C.includes("Admin")||C.includes("Manager")||C.includes("HR"))&&f.push({route:"employees.index",label:"Employee Management"},{route:"competency-assessments.index",label:"All Assessments"}),C.includes("Admin")&&f.push({route:"admin.roles.index",label:"Role Management"},{route:"system-settings.index",label:"System Settings"},{route:"organizational-analytics.index",label:"Analytics"}),f}),g=v(()=>[...A.value,...u.value]),w=v(()=>["block px-4 py-2 text-sm transition-colors",a.value?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"]),N=C=>{var f;return t.currentRoute===C||((f=t.currentRoute)==null?void 0:f.startsWith(C.split(".")[0]))},z=()=>{fe.post(route("logout"))};return(C,f)=>{var O;return m(),h("nav",{class:I(["w-full border-b transition-colors duration-200 sticky top-0 z-50",y(a)?"bg-gray-900 border-gray-700":"bg-white border-gray-200"])},[s("div",$e,[s("div",Ee,[s("div",Me,[s("div",Ne,[s("h1",{class:I(["text-xl font-bold",y(a)?"text-white":"text-gray-900"])}," HR Management ",2)]),s("div",Le,[(m(!0),h(j,null,H(A.value,b=>(m(),h("a",{key:b.route,href:C.route(b.route),class:I(["px-3 py-2 rounded-md text-sm font-medium transition-colors",N(b.route)?y(a)?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-700":y(a)?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"])},M(b.label),11,Pe))),128)),s("div",{class:"relative",onMouseenter:f[0]||(f[0]=b=>i.value=!0),onMouseleave:f[1]||(f[1]=b=>i.value=!1)},[s("button",{class:I(["px-3 py-2 rounded-md text-sm font-medium transition-colors flex items-center",y(a)?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"])},f[6]||(f[6]=[X(" More "),s("svg",{class:"ml-1 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)]),2),te(s("div",{class:I(["absolute left-0 mt-1 w-56 rounded-md shadow-lg z-50",y(a)?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"])},[s("div",De,[(m(!0),h(j,null,H(u.value,b=>(m(),h("a",{key:b.route,href:C.route(b.route),class:I(["block px-4 py-2 text-sm transition-colors",N(b.route)?y(a)?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-700":y(a)?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"])},M(b.label),11,Fe))),128))])],2),[[oe,i.value]])],32)])]),s("div",Oe,[s("button",{onClick:f[2]||(f[2]=(...b)=>y(r)&&y(r)(...b)),class:I(["p-2 rounded-md transition-colors",y(a)?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"])},[y(a)?(m(),h("svg",Re,f[7]||(f[7]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)]))):(m(),h("svg",ze,f[8]||(f[8]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])))],2),s("div",{class:"relative",onMouseenter:f[3]||(f[3]=b=>k.value=!0),onMouseleave:f[4]||(f[4]=b=>k.value=!1)},[s("button",{class:I(["flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors",y(a)?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"])},[s("div",{class:I(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium",y(a)?"bg-blue-600 text-white":"bg-blue-500 text-white"])},M(B.value),3),s("span",Qe,M((O=y(e))==null?void 0:O.name),1),f[9]||(f[9]=s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))],2),te(s("div",{class:I(["absolute right-0 mt-1 w-48 rounded-md shadow-lg z-50",y(a)?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"])},[s("div",Ge,[s("a",{href:C.route("profile.edit"),class:I(w.value)},"Profile Settings",10,Ue),s("button",{onClick:z,class:I([w.value,"w-full text-left text-red-600 hover:text-red-700 hover:bg-red-50"])}," Sign Out ",2)])],2),[[oe,k.value]])],32)])])]),s("div",We,[s("button",{onClick:f[5]||(f[5]=b=>p.value=!p.value),class:I(["w-full flex items-center justify-between px-3 py-2 rounded-md text-sm font-medium",y(a)?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"])},[f[11]||(f[11]=X(" Menu ")),(m(),h("svg",{class:I(["w-4 h-4 transition-transform",{"rotate-180":p.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},f[10]||(f[10]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))],2),te(s("div",je,[(m(!0),h(j,null,H(g.value,b=>(m(),h("a",{key:b.route,href:C.route(b.route),class:I(["block px-3 py-2 rounded-md text-sm font-medium transition-colors",N(b.route)?y(a)?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-700":y(a)?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"])},M(b.label),11,He))),128))],512),[[oe,p.value]])])],2)}}};function Ze(c,t){return m(),h("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"})])}function qe(c,t){return m(),h("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})])}const Je=["aria-live"],Ye={class:"toast-content"},Xe={key:0,class:"toast-icon"},Ke={class:"toast-message"},et={key:0,class:"toast-title"},tt={class:"toast-text"},ot={key:1,class:"toast-actions"},st=["aria-label"],nt={__name:"ToastNotification",props:{message:{type:String,required:!0},title:{type:String,default:""},type:{type:String,default:"info",validator:c=>["success","error","warning","info","loading"].includes(c)},position:{type:String,default:"top-right",validator:c=>["top-left","top-center","top-right","bottom-left","bottom-center","bottom-right"].includes(c)},duration:{type:Number,default:5e3},priority:{type:String,default:"normal",validator:c=>["low","normal","high"].includes(c)},closable:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},showProgress:{type:Boolean,default:!0},actionText:{type:String,default:""},icon:{type:String,default:""},size:{type:String,default:"md",validator:c=>["sm","md","lg"].includes(c)},sound:{type:Boolean,default:!1},persistent:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},closeLabel:{type:String,default:"Close notification"}},emits:["close","action"],setup(c,{expose:t,emit:e}){const o=c,a=e,r=_(!1),i=_(null),k=_(null),p=_(100),B=_(!1),A=_(0),u=_(0),g=v(()=>ne("x-mark")),w=v(()=>{if(o.icon)return ne(o.icon);const x={success:"check-circle",error:"x-circle",warning:"exclamation-triangle",info:"information-circle",loading:"loading"};return ne(x[o.type]||x.info)}),N=v(()=>["toast-notification",`toast-notification--${o.type}`,`toast-notification--${o.size}`,`toast-notification--${o.position}`,{"toast-notification--with-title":o.title,"toast-notification--persistent":o.persistent,"toast-notification--with-action":o.actionText}]),z=v(()=>({zIndex:o.zIndex})),C=v(()=>["w-5 h-5",{"animate-spin":o.type==="loading"}]),f=v(()=>o.closable||o.actionText),O=v(()=>[`toast-progress--${o.type}`]),b=v(()=>({width:`${p.value}%`})),n=()=>{r.value=!0,o.sound&&S(),!o.persistent&&o.duration>0&&D()},l=()=>{r.value=!1,E(),a("close")},$=()=>{a("action"),o.persistent||l()},D=()=>{o.duration<=0||(A.value=Date.now(),u.value=o.duration,i.value=setTimeout(()=>{l()},o.duration),R())},R=()=>{if(!o.showProgress)return;const x=Date.now(),F=()=>{if(!r.value||B.value)return;const me=Date.now()-x,le=Math.max(0,100-me/o.duration*100);p.value=le,le>0&&(k.value=requestAnimationFrame(F))};F()},d=()=>{if(!i.value||o.persistent)return;B.value=!0,clearTimeout(i.value),cancelAnimationFrame(k.value);const x=Date.now()-A.value;u.value=Math.max(0,o.duration-x)},T=()=>{!B.value||o.persistent||(B.value=!1,u.value>0&&(A.value=Date.now(),i.value=setTimeout(()=>{l()},u.value),R()))},E=()=>{i.value&&(clearTimeout(i.value),i.value=null),k.value&&(cancelAnimationFrame(k.value),k.value=null)},S=()=>{try{const x=new Audio,F={success:"data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT",error:"data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT",warning:"data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT",info:"data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT"};x.src=F[o.type]||F.info,x.volume=.3,x.play().catch(()=>{})}catch{}};return G(()=>{n()}),J(()=>{E()}),re(()=>o.duration,()=>{r.value&&!o.persistent&&(E(),D())}),t({show:n,close:l,pauseTimer:d,resumeTimer:T}),(x,F)=>(m(),q(ve,{to:"body"},[r.value?(m(),h("div",{key:0,class:I(N.value),style:ce(z.value),role:"alert","aria-live":c.priority==="high"?"assertive":"polite",onMouseenter:d,onMouseleave:T},[s("div",Ye,[c.showIcon?(m(),h("div",Xe,[(m(),q(K(w.value),{class:I(C.value)},null,8,["class"]))])):P("",!0),s("div",Ke,[c.title?(m(),h("div",et,M(c.title),1)):P("",!0),s("div",tt,[ae(x.$slots,"default",{},()=>[X(M(c.message),1)],!0)])]),f.value?(m(),h("div",ot,[c.actionText?(m(),h("button",{key:0,onClick:$,class:"toast-action-button"},M(c.actionText),1)):P("",!0),c.closable?(m(),h("button",{key:1,onClick:l,class:"toast-close-button","aria-label":c.closeLabel},[(m(),q(K(g.value),{class:"w-4 h-4"}))],8,st)):P("",!0)])):P("",!0)]),c.showProgress&&c.duration>0?(m(),h("div",{key:0,class:I(["toast-progress",O.value]),style:ce(b.value)},null,6)):P("",!0)],46,Je)):P("",!0)]))}},at=Y(nt,[["__scopeId","data-v-11baa49e"]]);class rt{constructor(){this.notifications=se([]),this.maxNotifications=_(5),this.defaultDuration=_(5e3),this.positions=se({"top-left":[],"top-center":[],"top-right":[],"bottom-left":[],"bottom-center":[],"bottom-right":[]}),this.idCounter=0,this.sounds=se({enabled:!0,volume:.3})}add(t){const e=this.generateId(),o=t.position||"top-right",a={id:e,message:t.message||"",title:t.title||"",type:t.type||"info",position:o,duration:t.duration!==void 0?t.duration:this.defaultDuration.value,persistent:t.persistent||!1,closable:t.closable!==!1,showIcon:t.showIcon!==!1,showProgress:t.showProgress!==!1,actionText:t.actionText||"",icon:t.icon||"",size:t.size||"md",sound:t.sound!==!1&&this.sounds.enabled,priority:t.priority||"normal",zIndex:t.zIndex||1e3,createdAt:Date.now(),onAction:t.onAction||null,onClose:t.onClose||null,component:t.component||null,props:t.props||{}};return this.notifications.push(a),this.positions[o].push(a),this.manageQueueSize(o),!a.persistent&&a.duration>0&&setTimeout(()=>{this.remove(e)},a.duration),e}remove(t){const e=this.notifications.find(i=>i.id===t);if(!e)return;const o=this.notifications.findIndex(i=>i.id===t);o>-1&&this.notifications.splice(o,1);const a=this.positions[e.position],r=a.findIndex(i=>i.id===t);r>-1&&a.splice(r,1),e.onClose&&e.onClose(e)}clear(){this.notifications.splice(0),Object.keys(this.positions).forEach(t=>{this.positions[t].splice(0)})}clearPosition(t){[...this.positions[t]].forEach(o=>{this.remove(o.id)})}clearType(t){this.notifications.filter(o=>o.type===t).forEach(o=>{this.remove(o.id)})}update(t,e){const o=this.notifications.find(a=>a.id===t);o&&Object.assign(o,e)}getByPosition(t){return this.positions[t]||[]}getByType(t){return this.notifications.filter(e=>e.type===t)}getById(t){return this.notifications.find(e=>e.id===t)}exists(t){return this.notifications.some(e=>e.id===t)}count(){return this.notifications.length}countByPosition(t){var e;return((e=this.positions[t])==null?void 0:e.length)||0}setMaxNotifications(t){this.maxNotifications.value=t,Object.keys(this.positions).forEach(e=>{this.manageQueueSize(e)})}setDefaultDuration(t){this.defaultDuration.value=t}setSoundsEnabled(t){this.sounds.enabled=t}setSoundVolume(t){this.sounds.volume=Math.max(0,Math.min(1,t))}pauseAll(){this.notifications.forEach(t=>{t.pauseTimer&&t.pauseTimer()})}resumeAll(){this.notifications.forEach(t=>{t.resumeTimer&&t.resumeTimer()})}success(t,e={}){return this.add({message:t,type:"success",...e})}error(t,e={}){return this.add({message:t,type:"error",persistent:e.persistent!==!1,...e})}warning(t,e={}){return this.add({message:t,type:"warning",...e})}info(t,e={}){return this.add({message:t,type:"info",...e})}loading(t,e={}){return this.add({message:t,type:"loading",persistent:!0,closable:!1,...e})}confirm(t={}){return new Promise(e=>{const o=this.add({type:"confirm",persistent:!0,closable:!1,component:"NotificationModal",props:{visible:!0,type:"confirm",title:t.title||"Confirm Action",description:t.message||"Are you sure you want to proceed?",confirmText:t.confirmText||"Confirm",cancelText:t.cancelText||"Cancel",...t},onAction:a=>{this.remove(o),e(a==="confirm")},onClose:()=>{e(!1)}})})}alert(t,e={}){return new Promise(o=>{const a=this.add({type:e.type||"info",persistent:!0,closable:!1,component:"NotificationModal",props:{visible:!0,type:e.type||"info",title:e.title||"Alert",description:t,showCancel:!1,confirmText:e.confirmText||"OK",...e},onAction:()=>{this.remove(a),o(!0)},onClose:()=>{o(!0)}})})}generateId(){return`notification-${++this.idCounter}-${Date.now()}`}manageQueueSize(t){const e=this.positions[t];e.length>this.maxNotifications.value&&e.splice(0,e.length-this.maxNotifications.value).forEach(a=>{const r=this.notifications.findIndex(i=>i.id===a.id);r>-1&&this.notifications.splice(r,1)})}}const L=new rt,it={class:"notification-container"},lt={__name:"NotificationContainer",setup(c,{expose:t}){const e=["top-left","top-center","top-right","bottom-left","bottom-center","bottom-right"];v(()=>L.notifications.filter(u=>!u.component));const o=v(()=>L.notifications.filter(u=>u.component)),a=u=>{const g="fixed z-50 pointer-events-none",w={"top-left":"top-4 left-4","top-center":"top-4 left-1/2 transform -translate-x-1/2","top-right":"top-4 right-4","bottom-left":"bottom-4 left-4","bottom-center":"bottom-4 left-1/2 transform -translate-x-1/2","bottom-right":"bottom-4 right-4"};return`${g} ${w[u]||w["top-right"]}`},r=u=>L.getByPosition(u),i=u=>u.includes("left")?"slide-left":u.includes("right")?"slide-right":u.includes("center")?"slide-center":"slide-right",k=u=>{L.remove(u)},p=(u,g="action")=>{const w=L.getById(u);w!=null&&w.onAction&&w.onAction(g)},B=()=>{window.notify={success:(u,g)=>L.success(u,g),error:(u,g)=>L.error(u,g),warning:(u,g)=>L.warning(u,g),info:(u,g)=>L.info(u,g),loading:(u,g)=>L.loading(u,g),confirm:u=>L.confirm(u),alert:(u,g)=>L.alert(u,g),clear:()=>L.clear(),remove:u=>L.remove(u)}},A=()=>{window.notify&&delete window.notify};return G(()=>{B()}),J(()=>{A()}),t({notificationQueue:L,notify:window.notify}),(u,g)=>(m(),h("div",it,[(m(),h(j,null,H(e,w=>s("div",{key:w,class:I(a(w))},[Q(pe,{name:i(w),tag:"div",class:"space-y-2"},{default:he(()=>[(m(!0),h(j,null,H(r(w),N=>(m(),q(at,ue({key:N.id},{ref_for:!0},N,{onClose:z=>k(N.id),onAction:z=>p(N.id)}),null,16,["onClose","onAction"]))),128))]),_:2},1032,["name"])],2)),64)),(m(!0),h(j,null,H(o.value,w=>(m(),q(K(w.component||"NotificationModal"),ue({key:w.id,ref_for:!0},w.props,{onClose:N=>k(w.id),onConfirm:N=>p(w.id,"confirm"),onCancel:N=>p(w.id,"cancel")}),null,16,["onClose","onConfirm","onCancel"]))),128))]))}},ct=Y(lt,[["__scopeId","data-v-67e6c621"]]),ut={class:"floating-attendance-widget"},dt={class:"status-indicator"},mt={class:"time-info"},ft={class:"time-display"},vt={class:"time-label-mini"},ht={class:"widget-header"},pt={class:"status-info"},gt={class:"status-text"},yt={class:"timer-section"},kt={class:"timer-value"},wt={class:"timer-label"},bt={class:"quick-actions"},xt=["disabled"],_t=["disabled"],At={class:"quick-stats"},Tt={class:"stat"},It={class:"stat-value"},Bt={class:"stat"},St={class:"stat-value"},Ct={__name:"FloatingAttendanceWidget",setup(c){const t=_(!1),e=_({clockedIn:!1,onBreak:!1,clockInTime:null}),o=_(!1),a=_("0h 0m 0s"),r=_(null),i=()=>{try{const d={clockedIn:e.value.clockedIn,onBreak:e.value.onBreak,clockInTime:e.value.clockInTime,breakStartTime:r.value,lastUpdate:new Date().toISOString()};localStorage.setItem("floating-attendance-state",JSON.stringify(d))}catch(d){console.warn("Failed to save attendance state to localStorage:",d)}},k=()=>{try{const d=localStorage.getItem("floating-attendance-state");if(d){const T=JSON.parse(d),E=new Date(T.lastUpdate);if((new Date-E)/(1e3*60)<5)return e.value.clockedIn=T.clockedIn||!1,e.value.onBreak=T.onBreak||!1,e.value.clockInTime=T.clockInTime||null,r.value=T.breakStartTime||null,!0}}catch(d){console.warn("Failed to load attendance state from localStorage:",d)}return!1};let p=null;const B=v(()=>e.value.onBreak?"On Break":e.value.clockedIn?"Working":"Clocked Out"),A=v(()=>e.value.onBreak?"BREAK TIME":e.value.clockedIn?"WORK TIME":"NOT ACTIVE"),u=v(()=>["status-dot",{"status-dot--working":e.value.clockedIn&&!e.value.onBreak,"status-dot--break":e.value.onBreak,"status-dot--out":!e.value.clockedIn}]),g=v(()=>[{"floating-button--working":e.value.clockedIn&&!e.value.onBreak,"floating-button--break":e.value.onBreak,"floating-button--out":!e.value.clockedIn}]),w=v(()=>o.value?"...":e.value.clockedIn?"Clock Out":"Clock In"),N=v(()=>["primary-action",e.value.clockedIn?"primary-action--danger":"primary-action--success"]),z=v(()=>{if(!e.value.clockedIn||!e.value.clockInTime)return"0h 0m";const d=new Date(e.value.clockInTime),E=new Date-d,S=Math.floor(E/(1e3*60)),x=Math.floor(S/60),F=S%60;return`${x}h ${F}m`}),C=v(()=>{if(e.value.onBreak&&r.value){const d=new Date(r.value);if(isNaN(d.getTime()))return"0h 0m 1s";{const E=Math.max(0,new Date-d),S=Math.floor(E/(1e3*60*60)),x=Math.floor(E%(1e3*60*60)/(1e3*60)),F=Math.floor(E%(1e3*60)/1e3);return`${S}h ${x}m ${F}s`}}return"0h 0m"});v(()=>["clock",{"clock--working":e.value.clockedIn&&!e.value.onBreak,"clock--break":e.value.onBreak,"clock--out":!e.value.clockedIn}]);const f=()=>{t.value=!t.value},O=()=>{if(e.value.clockedIn&&e.value.clockInTime){const d=new Date;let T;e.value.onBreak&&r.value?T=new Date(r.value):T=new Date(e.value.clockInTime);const E=d-T,S=Math.floor(E/(1e3*60*60)),x=Math.floor(E%(1e3*60*60)/(1e3*60)),F=Math.floor(E%(1e3*60)/1e3);a.value=`${S}h ${x}m ${F}s`}else a.value="0h 0m 0s"},b=async()=>{try{if(o.value=!0,e.value.clockedIn){const d=await window.axios.post("/api/attendance/clock-out",{timestamp:new Date().toISOString()});e.value.clockedIn=!1,e.value.onBreak=!1,e.value.clockInTime=null,r.value=null,a.value="0h 0m 0s",i(),R()}else{const d=await window.axios.post("/api/attendance/clock-in",{timestamp:new Date().toISOString()});e.value.clockedIn=!0,e.value.onBreak=!1,e.value.clockInTime=d.data.clock_in_time||new Date().toISOString(),i(),R()}}catch(d){console.error("Clock in/out failed:",d),alert("Action failed: "+d.message)}finally{o.value=!1}},n=async()=>{try{if(o.value=!0,e.value.onBreak){const d=await window.axios.post("/api/attendance/break-end",{timestamp:new Date().toISOString()});e.value.onBreak=!1,r.value=null,i(),R()}else{r.value=new Date().toISOString(),e.value.onBreak=!0;const d=await window.axios.post("/api/attendance/break-start",{timestamp:new Date().toISOString()});d.data.break_start_time&&(r.value=d.data.break_start_time),i(),R()}}catch(d){console.error("Break action failed:",d),alert("Action failed: "+d.message)}finally{o.value=!1}},l=async()=>{var d,T;try{const S=(await window.axios.get("/api/attendance/current")).data;if(e.value.clockedIn=S.clocked_in||!1,e.value.onBreak=S.on_break||!1,e.value.clockInTime=S.clock_in_time||null,S.on_break)if(S.break_start_time)r.value=S.break_start_time;else if((d=S.current_session)!=null&&d.current_break_start)r.value=S.current_session.current_break_start;else if((T=S.current_session)!=null&&T.break_sessions&&S.current_session.break_sessions.length>0){const x=S.current_session.break_sessions[S.current_session.break_sessions.length-1];x&&!x.end&&(r.value=x.start)}else r.value||(r.value=new Date().toISOString());else r.value=null;console.log("FloatingWidget: Fetched status:",{clockedIn:e.value.clockedIn,onBreak:e.value.onBreak,breakStartTime:r.value})}catch(E){console.error("Failed to fetch attendance status:",E)}},$=d=>{d.key==="attendance-update"&&l()},D=d=>{console.log("FloatingWidget: Received attendance state change:",d.detail);const{clockedIn:T,onBreak:E,clockInTime:S,breakStartTime:x}=d.detail;e.value.clockedIn=T,e.value.onBreak=E,e.value.clockInTime=S,E&&x?r.value=x:E||(r.value=null),i(),O(),console.log("FloatingWidget: State updated to:",{clockedIn:e.value.clockedIn,onBreak:e.value.onBreak,breakStartTime:r.value,eventBreakStartTime:x})},R=()=>{try{localStorage.setItem("attendance-update",Date.now().toString()),localStorage.removeItem("attendance-update")}catch(d){console.warn("Failed to broadcast attendance update:",d)}};return G(async()=>{k()&&O(),await l(),i(),O(),p=setInterval(O,1e3),window.addEventListener("storage",$),window.addEventListener("attendance-state-changed",D),console.log("FloatingWidget: Event listeners registered")}),J(()=>{p&&clearInterval(p),window.removeEventListener("storage",$),window.removeEventListener("attendance-state-changed",D),console.log("FloatingWidget: Event listeners removed")}),(d,T)=>(m(),h("div",ut,[t.value?P("",!0):(m(),h("div",{key:0,onClick:f,class:I(["floating-button",g.value])},[s("div",dt,[s("div",{class:I(u.value)},null,2)]),s("div",mt,[s("div",ft,M(a.value),1),s("div",vt,M(A.value),1)]),Q(y(we),{class:"w-4 h-4 expand-icon"})],2)),t.value?(m(),h("div",{key:1,class:"expanded-widget",onClick:T[0]||(T[0]=ge(()=>{},["stop"]))},[s("div",ht,[s("div",pt,[s("div",{class:I(u.value)},null,2),s("span",gt,M(B.value),1)]),s("button",{onClick:f,class:"minimize-btn",title:"Minimize"},[Q(y(be),{class:"w-4 h-4"})])]),s("div",yt,[s("div",kt,M(a.value),1),s("div",wt,M(A.value),1)]),s("div",bt,[s("button",{onClick:b,disabled:o.value,class:I(N.value)},M(w.value),11,xt),e.value.clockedIn?(m(),h("button",{key:0,onClick:n,disabled:o.value,class:"break-action"},[(m(),q(K(e.value.onBreak?y(qe):y(Ze)),{class:"w-3 h-3"})),X(" "+M(e.value.onBreak?"End":"Break"),1)],8,_t)):P("",!0)]),s("div",At,[s("div",Tt,[s("span",It,M(z.value),1),T[1]||(T[1]=s("span",{class:"stat-label"},"Today",-1))]),s("div",Bt,[s("span",St,M(C.value),1),T[2]||(T[2]=s("span",{class:"stat-label"},"Break",-1))])])])):P("",!0),t.value?(m(),h("div",{key:2,class:"backdrop",onClick:f})):P("",!0)]))}},$t=Y(Ct,[["__scopeId","data-v-421365b8"]]),Et={class:"skip-links","aria-label":"Skip navigation links"},Mt=["href","onClick"],Nt={__name:"SkipLinks",setup(c){const{skipLinks:t,handleSkipLinkClick:e}=xe();return(o,a)=>(m(),h("div",Et,[(m(!0),h(j,null,H(y(t),r=>(m(),h("a",{key:r.href,href:r.href,class:"skip-link sr-only-focusable",onClick:i=>y(e)(i,r.href)},M(r.label),9,Mt))),128))]))}},Lt=Y(Nt,[["__scopeId","data-v-f9a7b518"]]),Pt={class:"live-regions"},Dt={__name:"LiveRegion",setup(c){const t=_(null),e=_(null),o=_(null);return G(()=>{ye.init()}),(a,r)=>(m(),h("div",Pt,[s("div",{id:"aria-live-polite","aria-live":"polite","aria-atomic":"true",class:"sr-only",ref_key:"politeRegion",ref:t},null,512),s("div",{id:"aria-live-assertive","aria-live":"assertive","aria-atomic":"true",class:"sr-only",ref_key:"assertiveRegion",ref:e},null,512),s("div",{id:"aria-live-status","aria-live":"polite","aria-atomic":"true",role:"status",class:"sr-only",ref_key:"statusRegion",ref:o},null,512)]))}},Ft=Y(Dt,[["__scopeId","data-v-94955163"]]);function Ot(){const{props:c}=ie(),{user:t}=ee();let e;const o=()=>{Notification.permission==="granted"?navigator.serviceWorker.ready.then(r=>{var k;const i=((k=t.value)==null?void 0:k.name)||"Employee";r.showNotification(`Hi ${i}, Ready to Clock In?`,{body:"A new day of productivity awaits! Click here to start your timer.",icon:"/favicon.ico",tag:"clock-in-reminder",actions:[{action:"clock-in",title:"Clock In"}]})}):console.log("notification permission not granted")},a=()=>{const r=new Date,i=new Date(c.auth.user.clock_in_time);(isNaN(i.getTime())||r.getTime()-i.getTime()>5*60*1e3)&&o()};G(()=>{a(),e=setInterval(a,5*60*1e3)}),J(()=>{clearInterval(e)})}function Rt(){const{isAuthenticated:c,user:t}=ee(),e=ie();let o=null;const a=()=>{Notification.permission==="granted"?navigator.serviceWorker.ready.then(i=>{var p;const k=((p=t.value)==null?void 0:p.name)||"Employee";i.showNotification(`Hi ${k}, Gentle Reminder to Submit Your Work Report`,{body:"Please submit your work report for today.",icon:"/favicon.ico",tag:"work-report-reminder",actions:[{action:"submit-work-report",title:"Submit Now"}]})}):console.log("notification permission not granted")},r=()=>{if(!c.value)return;const i=e.props.auth.user.todays_attendance;if(i&&i.clock_in_time&&!i.clock_out_time){const k=new Date(i.clock_in_time);(new Date-k)/1e3/60/60>=7.5&&a()}};G(()=>{o=setInterval(r,5*60*1e3),r()}),J(()=>{o&&clearInterval(o)})}function zt(){const c=ie();return re(()=>c.props.flash,t=>{!t||!window.notify||(t.success&&window.notify.success(t.success),t.error&&window.notify.error(t.error),t.warning&&window.notify.warning(t.warning),t.info&&window.notify.info(t.info))},{immediate:!0,deep:!0}),{flash:c.props.flash}}const Qt={key:0,class:"p-4 bg-red-100 border border-red-400 text-red-700 z-50 relative"},Gt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},Ut={id:"main-content",class:"flex-1",role:"main","aria-label":"Main content",tabindex:"-1"},Wt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Jt={__name:"AuthenticatedLayout",setup(c){const t=ke();_("desktop");const{getUserProperty:e,getAuthError:o}=ee(),{isDark:a,initializeTheme:r}=de();Ot(),Rt(),zt(),G(()=>{r()}),v(()=>e("name","User")),v(()=>e("email",""));const i=v(()=>o()),k=v(()=>!!i.value),p=v(()=>{try{return route().current()||""}catch(B){return console.warn("[LAYOUT] Route helper not available:",B),window.location.pathname.replace("/","")||"dashboard"}});return v(()=>!!t.header),(B,A)=>(m(),h("div",null,[Q(Lt),Q(Ft),Q(Ce),Q(ct),Q($t),k.value?(m(),h("div",Qt,[A[0]||(A[0]=s("p",{class:"font-semibold"},"Authentication Error:",-1)),s("p",null,M(i.value),1),A[1]||(A[1]=s("p",{class:"text-sm mt-1"},"Please refresh the page or contact support if the issue persists.",-1))])):P("",!0),Q(Ve,{"current-route":p.value},null,8,["current-route"]),s("div",{class:I(["min-h-screen transition-colors duration-200",(y(a),"bg-gray-50")])},[y(t).header?(m(),h("header",{key:0,class:I(["border-b transition-colors duration-200",(y(a),"bg-white border-gray-200")]),role:"banner","aria-label":"Page header"},[s("div",Gt,[s("div",{class:I(["text-2xl font-bold transition-colors duration-200",(y(a),"text-gray-900")])},[ae(B.$slots,"header")],2)])],2)):P("",!0),s("main",Ut,[s("div",Wt,[ae(B.$slots,"default")])])],2)]))}};export{Jt as _,Ze as a,L as n,qe as r,zt as u};
