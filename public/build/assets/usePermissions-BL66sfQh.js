import{u as S}from"./useAuth-CMEdgtFP.js";import{c as n}from"./app-pjQvhOqR.js";function v(){const{isAuthenticated:s,roles:c,hasRole:i,hasAnyRole:t}=S(),u=(E,a)=>{},r=(E,a={})=>{try{return a.requireAuth!==!1&&!s.value?a.fallback!==void 0?a.fallback:!1:E()}catch(T){return u(T,a.operation||"unknown operation"),a.fallback!==void 0?a.fallback:!1}},e={EMPLOYEE_VIEW:"employee.view",EMPLOYEE_CREATE:"employee.create",EMPLOYEE_EDIT:"employee.edit",EMPLOYEE_DELETE:"employee.delete",DEPARTMENT_VIEW:"department.view",DEPARTMENT_CREATE:"department.create",DEPARTMENT_EDIT:"department.edit",DEPARTMENT_DELETE:"department.delete",LEAVE_VIEW:"leave.view",LEAVE_CREATE:"leave.create",LEAVE_APPROVE:"leave.approve",LEAVE_DELETE:"leave.delete",ATTENDANCE_VIEW:"attendance.view",ATTENDANCE_EDIT:"attendance.edit",ATTENDANCE_REPORT:"attendance.report",PROJECT_VIEW:"project.view",PROJECT_CREATE:"project.create",PROJECT_EDIT:"project.edit",PROJECT_DELETE:"project.delete",TASK_VIEW:"task.view",TASK_CREATE:"task.create",TASK_EDIT:"task.edit",TASK_ASSIGN:"task.assign",FEEDBACK_VIEW:"feedback.view",FEEDBACK_CREATE:"feedback.create",FEEDBACK_RESPOND:"feedback.respond",ADMIN_USERS:"admin.users",ADMIN_ROLES:"admin.roles",ADMIN_SETTINGS:"admin.settings"},A={Admin:Object.values(e),HR:[e.EMPLOYEE_VIEW,e.EMPLOYEE_CREATE,e.EMPLOYEE_EDIT,e.DEPARTMENT_VIEW,e.DEPARTMENT_CREATE,e.DEPARTMENT_EDIT,e.LEAVE_VIEW,e.LEAVE_APPROVE,e.ATTENDANCE_VIEW,e.ATTENDANCE_REPORT,e.FEEDBACK_VIEW,e.FEEDBACK_RESPOND],Manager:[e.EMPLOYEE_VIEW,e.LEAVE_VIEW,e.LEAVE_APPROVE,e.ATTENDANCE_VIEW,e.PROJECT_VIEW,e.PROJECT_CREATE,e.PROJECT_EDIT,e.TASK_VIEW,e.TASK_CREATE,e.TASK_EDIT,e.TASK_ASSIGN,e.FEEDBACK_VIEW],Employee:[e.LEAVE_VIEW,e.LEAVE_CREATE,e.ATTENDANCE_VIEW,e.PROJECT_VIEW,e.TASK_VIEW,e.TASK_CREATE,e.TASK_EDIT,e.FEEDBACK_CREATE]},l=n(()=>r(()=>{if(!s.value||!c.value.length)return[];const E=new Set;return c.value.forEach(a=>{(A[a]||[]).forEach(D=>E.add(D))}),Array.from(E)},{fallback:[],operation:"getting user permissions",component:"usePermissions",requireAuth:!1})),o=E=>r(()=>!E||typeof E!="string"?(console.warn("[PERMISSIONS] Invalid permission parameter:",E),!1):s.value?l.value.includes(E):!1,{fallback:!1,operation:`checking permission: ${E}`,component:"usePermissions"}),m=E=>r(()=>Array.isArray(E)?s.value?E.some(a=>o(a)):!1:(console.warn("[PERMISSIONS] hasAnyPermission expects an array:",E),!1),{fallback:!1,operation:`checking any permissions: ${E}`,component:"usePermissions"}),_=E=>r(()=>Array.isArray(E)?s.value?E.every(a=>o(a)):!1:(console.warn("[PERMISSIONS] hasAllPermissions expects an array:",E),!1),{fallback:!1,operation:`checking all permissions: ${E}`,component:"usePermissions"}),P=E=>{try{return i(E)}catch{return!1}},R=n(()=>r(()=>t(["Admin","HR"]),{fallback:!1,operation:"checking employee management access",component:"usePermissions"})),f=n(()=>r(()=>t(["Admin","HR","Manager"]),{fallback:!1,operation:"checking HR operations access",component:"usePermissions"})),I=n(()=>r(()=>t(["Admin","HR","Manager"]),{fallback:!1,operation:"checking leave approval access",component:"usePermissions"})),p=n(()=>r(()=>t(["Admin","Manager"]),{fallback:!1,operation:"checking project management access",component:"usePermissions"})),d=n(()=>r(()=>i("Admin"),{fallback:!1,operation:"checking admin privileges",component:"usePermissions"}));return{PERMISSIONS:e,ROLE_PERMISSIONS:A,userPermissions:l,hasPermission:o,hasAnyPermission:m,hasAllPermissions:_,canAccessRole:P,canManageEmployees:R,canAccessHROperations:f,canApproveLeaves:I,canManageProjects:p,isAdmin:d,getPermissionSummary:()=>({}),debugPermissions:()=>{}}}export{v as u};
