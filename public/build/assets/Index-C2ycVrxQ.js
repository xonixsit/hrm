import{f as g,g as d,o as r,h as u,k as h,a as t,c as i,F as m,r as p,t as a,i as S,n as b,l as N,Q as _}from"./app-C9QNtCl1.js";import{A as E}from"./AuthenticatedLayout-Bg2dAg53.js";import{P as M}from"./PageLayout-BUyx_ARa.js";import{_ as V}from"./SimpleInfoCard-CCIW-oly.js";import{B as j}from"./BaseSelect-BVWtUugF.js";import{B as $}from"./BaseButton-OS9uEHp8.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAuth-CPvLbGOJ.js";import"./icons-CW5EwDlD.js";import"./useAccessibility-BRw03oqW.js";import"./PageHeader.vue_vue_type_style_index_0_scoped_cac8c3e5_lang-CC_acfXo.js";import"./PageHeader-qwFKR_iK.js";import"./Icon-Dgvq6PS7.js";/* empty css                                                                   */import"./ChartBarIcon-BxKbWyul.js";import"./UserGroupIcon-D4eew7DO.js";/* empty css                                                                   *//* empty css                                                                   */const F={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},H={class:"bg-white rounded-lg shadow-sm border border-neutral-200"},L={class:"overflow-x-auto"},P={class:"min-w-full divide-y divide-neutral-200 role-management-table"},D={class:"bg-white divide-y divide-neutral-200"},Q={class:"px-6 py-4 whitespace-nowrap"},T={class:"flex items-center"},Y={class:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0"},G={class:"text-sm font-semibold text-primary-700"},J={class:"ml-4 min-w-0"},O={class:"text-sm font-medium text-neutral-900 truncate"},q={class:"text-sm text-neutral-500 truncate"},K={class:"text-xs text-neutral-400"},W={class:"px-6 py-4 whitespace-nowrap"},X={class:"flex flex-wrap gap-1"},Z={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-neutral-100 text-neutral-800 role-badge"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-neutral-900"},te={class:"truncate"},se={class:"px-6 py-4 whitespace-nowrap"},oe={class:"px-6 py-4 text-sm font-medium"},ne={class:"flex flex-col space-y-3 w-44"},re={class:"space-y-2"},le={class:"space-y-2"},ae={key:1,class:"text-xs text-amber-700 bg-amber-50 border border-amber-200 rounded-md p-2 text-center font-medium"},ie={key:2,class:"text-xs text-neutral-500 bg-neutral-50 border border-neutral-200 rounded-md p-2 text-center"},ce={__name:"Index",props:{users:Array,availableRoles:Array,currentUserId:Number},setup(x){const l=x,v=[{label:"Dashboard",href:route("dashboard"),icon:"home"},{label:"Administration",href:"#"},{label:"Role Management",href:route("admin.roles.index"),current:!0}],y=g(()=>l.availableRoles.map(s=>({value:s,label:s}))),w=g(()=>{const s=l.availableRoles.map(e=>{const n=l.users.filter(c=>c.roles.includes(e)).length;return{name:e,count:n,icon:R(e),color:A(e)}}),o=l.users.filter(e=>e.roles.length===0).length;return o>0&&s.push({name:"No Role",count:o,icon:"UserIcon",color:"neutral"}),s});function k(s){return s.split(" ").map(o=>o.charAt(0)).join("").toUpperCase().slice(0,2)}function R(s){return{Admin:"ShieldCheckIcon",HR:"UserGroupIcon",Manager:"BriefcaseIcon",Employee:"UserIcon"}[s]||"UserIcon"}function A(s){return{Admin:"red",HR:"blue",Manager:"green",Employee:"yellow"}[s]||"neutral"}function C(s){return{Admin:"bg-red-100 text-red-800",HR:"bg-blue-100 text-blue-800",Manager:"bg-green-100 text-green-800",Employee:"bg-yellow-100 text-yellow-800"}[s]||"bg-neutral-100 text-neutral-800"}function f(s){return!(s.id===l.currentUserId&&s.roles.includes("Admin"))}function I(s){return s.id===l.currentUserId&&s.roles.includes("Admin")?"Cannot remove your own Admin role":""}function U(s,o){if(!o)return;const e=l.users.find(n=>n.id===s);if(s===l.currentUserId&&(e!=null&&e.roles.includes("Admin"))&&o!=="Admin"){alert("You cannot remove your own Admin role.");return}e!=null&&e.roles.includes(o)||_.post(route("admin.roles.assign",s),{role:o},{preserveScroll:!0,onSuccess:()=>{},onError:n=>{console.error("Error assigning role:",n),n.message?alert(n.message):alert("Failed to assign role. Please try again.")}})}function B(s,o){if(!o)return;if(s===l.currentUserId&&o==="Admin"){alert("You cannot remove your own Admin role.");return}const e=l.users.find(c=>c.id===s),n=(e==null?void 0:e.name)||"this user";confirm(`Are you sure you want to remove the ${o} role from ${n}?`)&&_.post(route("admin.roles.remove",s),{role:o},{preserveScroll:!0,onSuccess:()=>{},onError:c=>{console.error("Error removing role:",c),c.message?alert(c.message):alert("Failed to remove role. Please try again.")}})}return(s,o)=>(r(),d(E,null,{default:u(()=>[h(M,{title:"Role Management",subtitle:"Assign and manage user roles in the system",breadcrumbs:v},{default:u(()=>[t("div",F,[(r(!0),i(m,null,p(w.value,e=>(r(),d(V,{key:e.name,title:e.name,value:e.count,subtitle:`${e.count===1?"user":"users"} with this role`,icon:e.icon,color:e.color},null,8,["title","value","subtitle","icon","color"]))),128))]),t("div",H,[o[4]||(o[4]=t("div",{class:"px-6 py-4 border-b border-neutral-200"},[t("h3",{class:"text-lg font-semibold text-neutral-900"},"User Role Assignments"),t("p",{class:"text-sm text-neutral-600 mt-1"},"Manage roles for all employees in the system")],-1)),t("div",L,[t("table",P,[o[3]||(o[3]=t("thead",{class:"bg-neutral-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider"}," Employee "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider"}," Current Role "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider"}," Job Title "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider"}," Status "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider w-48"}," Role Actions ")])],-1)),t("tbody",D,[(r(!0),i(m,null,p(x.users,e=>(r(),i("tr",{key:e.id,class:"hover:bg-neutral-50 transition-colors duration-150"},[t("td",Q,[t("div",T,[t("div",Y,[t("span",G,a(k(e.name)),1)]),t("div",J,[t("div",O,a(e.name),1),t("div",q,a(e.email),1),t("div",K,"ID: "+a(e.employee_code),1)])])]),t("td",W,[t("div",X,[e.roles.length===0?(r(),i("span",Z," No Role ")):S("",!0),(r(!0),i(m,null,p(e.roles,n=>(r(),i("span",{key:n,class:b([C(n),"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium role-badge"])},a(n),3))),128))])]),t("td",ee,[t("span",te,a(e.job_title||"Not specified"),1)]),t("td",se,[t("span",{class:b([e.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800","inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize"])},a(e.status),3)]),t("td",oe,[t("div",ne,[t("div",re,[o[0]||(o[0]=t("label",{class:"block text-xs font-medium text-neutral-700"}," Assign Role ",-1)),h(j,{"model-value":e.roles[0]||"",options:y.value,placeholder:"Select role",size:"sm",class:"w-full","onUpdate:modelValue":n=>U(e.id,n)},null,8,["model-value","options","onUpdate:modelValue"])]),t("div",le,[o[2]||(o[2]=t("label",{class:"block text-xs font-medium text-neutral-700"}," Remove Role ",-1)),e.roles.length>0&&f(e)?(r(),d($,{key:0,variant:"outline",size:"sm",onClick:n=>B(e.id,e.roles[0]),class:"text-red-600 hover:text-red-700 border-red-200 hover:border-red-300 hover:bg-red-50 w-full justify-center transition-colors duration-150"},{default:u(()=>[o[1]||(o[1]=t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),N(" Remove "+a(e.roles[0]),1)]),_:2,__:[1]},1032,["onClick"])):e.roles.length>0&&!f(e)?(r(),i("div",ae,a(I(e)),1)):(r(),i("div",ie," No role assigned "))])])])]))),128))])])])])]),_:1})]),_:1}))}},Ue=z(ce,[["__scopeId","data-v-6fdb7f08"]]);export{Ue as default};
