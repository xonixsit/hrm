<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagination Fix Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .pagination { display: flex; gap: 10px; align-items: center; margin: 20px 0; }
        .page-button { 
            padding: 8px 12px; 
            border: 1px solid #ccc; 
            background: white; 
            cursor: pointer; 
            text-decoration: none;
            color: #333;
        }
        .page-button.active { background: #007bff; color: white; }
        .page-button:disabled { opacity: 0.5; cursor: not-allowed; }
        .page-button:hover:not(:disabled):not(.active) { background: #f0f0f0; }
        .debug { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Work Reports Pagination Fix Test</h1>
    
    <div class="test-section">
        <h3>Current Issue</h3>
        <p>The pagination links (1, 2, 3, etc.) are not working in the work reports page.</p>
        <p>Expected: Clicking page numbers should navigate to that page</p>
        <p>Actual: Page numbers are not clickable or navigation fails</p>
    </div>
    
    <div class="test-section">
        <h3>Test Navigation URLs</h3>
        <div class="pagination">
            <a href="/work-reports?page=1" class="page-button active">1</a>
            <a href="/work-reports?page=2" class="page-button">2</a>
            <a href="/work-reports?page=3" class="page-button">3</a>
        </div>
        <p>These should work as direct links. If they don't, the issue is in the backend routing.</p>
    </div>
    
    <div class="test-section">
        <h3>JavaScript Navigation Test</h3>
        <div class="pagination">
            <button class="page-button active" onclick="testNavigation(1)">1</button>
            <button class="page-button" onclick="testNavigation(2)">2</button>
            <button class="page-button" onclick="testNavigation(3)">3</button>
        </div>
        <div id="nav-log" class="debug">
            <strong>Navigation Log:</strong><br>
            <div id="log-content">Click a page number to test navigation...</div>
        </div>
    </div>
    
    <div class="test-section">
        <h3>Simulated Laravel Pagination Data</h3>
        <div class="debug">
            <pre id="pagination-data"></pre>
        </div>
        <button onclick="testPaginationParsing()">Test Pagination Data Parsing</button>
        <div id="parsing-result" class="debug" style="display: none;"></div>
    </div>

    <script>
        // Simulated Laravel pagination data
        const samplePaginationData = {
            current_page: 1,
            data: [
                { id: 1, date: '2025-08-15', calls: 126 },
                { id: 2, date: '2025-08-14', calls: 147 }
            ],
            first_page_url: "http://localhost/work-reports?page=1",
            from: 1,
            last_page: 3,
            last_page_url: "http://localhost/work-reports?page=3",
            links: [
                {
                    url: null,
                    label: "&laquo; Previous",
                    active: false
                },
                {
                    url: "http://localhost/work-reports?page=1",
                    label: "1",
                    active: true
                },
                {
                    url: "http://localhost/work-reports?page=2",
                    label: "2",
                    active: false
                },
                {
                    url: "http://localhost/work-reports?page=3",
                    label: "3",
                    active: false
                },
                {
                    url: "http://localhost/work-reports?page=2",
                    label: "Next &raquo;",
                    active: false
                }
            ],
            next_page_url: "http://localhost/work-reports?page=2",
            path: "http://localhost/work-reports",
            per_page: 10,
            prev_page_url: null,
            to: 10,
            total: 23
        };

        // Display the pagination data
        document.getElementById('pagination-data').textContent = JSON.stringify(samplePaginationData, null, 2);

        function testNavigation(page) {
            const logContent = document.getElementById('log-content');
            const timestamp = new Date().toLocaleTimeString();
            
            logContent.innerHTML += `<br>[${timestamp}] Testing navigation to page ${page}`;
            
            // Find the corresponding link from pagination data
            const pageLink = samplePaginationData.links.find(link => parseInt(link.label) === page);
            
            if (pageLink) {
                logContent.innerHTML += `<br>[${timestamp}] Found link: ${pageLink.url}`;
                if (pageLink.url) {
                    logContent.innerHTML += `<br>[${timestamp}] ‚úÖ Would navigate to: ${pageLink.url}`;
                    // In a real app, this would be: router.get(pageLink.url)
                    logContent.innerHTML += `<br>[${timestamp}] üîó Simulating navigation...`;
                    
                    // Simulate successful navigation
                    setTimeout(() => {
                        logContent.innerHTML += `<br>[${timestamp}] ‚úÖ Navigation completed successfully`;
                        updateActiveButton(page);
                    }, 500);
                } else {
                    logContent.innerHTML += `<br>[${timestamp}] ‚ùå Link URL is null - this is the problem!`;
                }
            } else {
                logContent.innerHTML += `<br>[${timestamp}] ‚ùå No link found for page ${page}`;
            }
        }

        function updateActiveButton(activePage) {
            // Update button states
            const buttons = document.querySelectorAll('.pagination button');
            buttons.forEach((btn, index) => {
                btn.classList.toggle('active', index + 1 === activePage);
            });
        }

        function testPaginationParsing() {
            const resultDiv = document.getElementById('parsing-result');
            resultDiv.style.display = 'block';
            
            // Test the parsing logic from the Vue component
            const prevLink = samplePaginationData.links.find(link => link.label === '&laquo; Previous');
            const nextLink = samplePaginationData.links.find(link => link.label === 'Next &raquo;');
            const pageLinks = samplePaginationData.links.filter(link => 
                link.label !== '&laquo; Previous' && 
                link.label !== 'Next &raquo;' &&
                !isNaN(parseInt(link.label))
            );
            
            const currentPageLink = pageLinks.find(link => link.active);
            const currentPageNum = currentPageLink ? parseInt(currentPageLink.label) : 1;
            const lastPageNum = pageLinks.length > 0 ? parseInt(pageLinks[pageLinks.length - 1].label) : 1;
            
            const parsedData = {
                currentPage: currentPageNum,
                lastPage: lastPageNum,
                hasPrevious: !!prevLink?.url,
                hasNext: !!nextLink?.url,
                previousUrl: prevLink?.url,
                nextUrl: nextLink?.url,
                total: samplePaginationData.total,
                from: samplePaginationData.from,
                to: samplePaginationData.to,
                perPage: samplePaginationData.per_page
            };
            
            resultDiv.innerHTML = `
                <strong>Parsed Pagination Data:</strong><br>
                <pre>${JSON.stringify(parsedData, null, 2)}</pre>
                <br>
                <strong>Page Links Analysis:</strong><br>
                ${pageLinks.map(link => `Page ${link.label}: ${link.url ? '‚úÖ Has URL' : '‚ùå No URL'} (Active: ${link.active})`).join('<br>')}
            `;
        }

        // Auto-run the parsing test on load
        window.onload = function() {
            testPaginationParsing();
        };
    </script>
</body>
</html>